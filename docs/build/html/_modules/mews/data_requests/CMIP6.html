<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mews.data_requests.CMIP6 &mdash; MEWS 0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> MEWS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MEWS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>mews.data_requests.CMIP6</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for mews.data_requests.CMIP6</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">CMIP6 data collection and calculations. Used when accounting for global warming</span>
<span class="sd">in MEWS.</span>

<span class="sd">Calculates temperature change values from a baseline year to a future year</span>
<span class="sd">for a specific latitude-longitude input. Compiles information from historical</span>
<span class="sd">global climate models and 5 SSP scenario models.</span>

<span class="sd">Created on Wed Jun 20 13:00:31 2022</span>

<span class="sd">@author: tschoste</span>

<span class="sd">----</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">threading</span> <span class="k">as</span> <span class="nn">thr</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c1">########## Setting Proxies ##############</span>
<span class="c1"># Needed if downloading files </span>
<span class="c1"># within Sandia</span>
<span class="n">proxy</span> <span class="o">=</span> <span class="s1">&#39;http://proxy.sandia.gov:80&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;http_proxy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span> 
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HTTP_PROXY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;https_proxy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HTTPS_PROXY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proxy</span>


<span class="c1">########## Initial Startup ##############</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1">#Removes depreciation warnings</span>

<div class="viewcode-block" id="CMIP_Data"><a class="viewcode-back" href="../../../mews.data_requests.CMIP6.html#mews.data_requests.CMIP6.CMIP_Data">[docs]</a><span class="k">class</span> <span class="nc">CMIP_Data</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; obj = CMIP_Data(lat_desired,</span>
<span class="sd">                        lon_desired,</span>
<span class="sd">                        year_baseline,</span>
<span class="sd">                        year_desired,</span>
<span class="sd">                        model_guide,</span>
<span class="sd">                        file_path)</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Results can be found in obj.delT which returns a dictionary of the </span>
<span class="sd">    temperature change values for each scenario based on year_desired.</span>
<span class="sd">    </span>
<span class="sd">    More complete results can be found in obj.total_model_data. This is a </span>
<span class="sd">    dictionary seperated based on scenario, that contains the following</span>
<span class="sd">    information based on the latitude-longitude input.</span>
<span class="sd">    </span>
<span class="sd">    .. list-table::</span>
<span class="sd">       :widths: 25 75</span>
<span class="sd">       :header-rows: 1</span>

<span class="sd">       * - Attribute</span>
<span class="sd">         - Description</span>
<span class="sd">       * - .start_year</span>
<span class="sd">         - The first year of data available for the scenario</span>
<span class="sd">       * - .end_year</span>
<span class="sd">         - The last year of data available for the scenario</span>
<span class="sd">       * - .year_temp_dict</span>
<span class="sd">         - A dictionary of lists containing the temperature values for each model</span>
<span class="sd">       * - .scenario</span>
<span class="sd">         - The selected scenario</span>
<span class="sd">       * - .avg_error_list</span>
<span class="sd">         - A list of the normalized interpolation error values for each model</span>
<span class="sd">       * - .delT_list</span>
<span class="sd">         - A list of all averaged temperature change values with the first entry </span>
<span class="sd">           corresponding to the start_year and the last entry corresponding to the </span>
<span class="sd">           end_year</span>
<span class="sd">       * - .CI_list</span>
<span class="sd">         - A list of the 95% confidence interval bounds for delT_list</span>
<span class="sd">       * - .delT_list_reg</span>
<span class="sd">         - A list of all regressed temperature change values with the first entry</span>
<span class="sd">           corresponding to the start_year and the last entry corresponding to the</span>
<span class="sd">           end_year</span>
<span class="sd">       * - .avg_error</span>
<span class="sd">         - The averaged error value for every model used in the scenario</span>
<span class="sd">         </span>
<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; obj.total_model_data[&quot;SSP119&quot;].start_year</span>
<span class="sd">    2015</span>
<span class="sd">    </span>
<span class="sd">    Plots can be generated through obj.results1 and obj.results2 (see below).</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lat_desired : float</span>
<span class="sd">        Latitude value used for temperature change calculations. Must be</span>
<span class="sd">        between -90 and 90 [degrees].</span>
<span class="sd">    </span>
<span class="sd">    lon_desired : float</span>
<span class="sd">        Longitude value used for temperature change calculations. Must be </span>
<span class="sd">        between -360 (when using degrees W) and 360 (when using degrees E).</span>
<span class="sd">        </span>
<span class="sd">    year_baseline : int</span>
<span class="sd">        Year input for the baseline temperature change. All delta_T&#39;s will </span>
<span class="sd">        be calculated from this year. 1850 &lt;= year &lt;= 2014.</span>
<span class="sd">        </span>
<span class="sd">    year_desired : int</span>
<span class="sd">        Future year input for which all temperature change values will be </span>
<span class="sd">        calculated to. 2015 &lt;= year &lt;= 2100.</span>
<span class="sd">        </span>
<span class="sd">    model_guide : str</span>
<span class="sd">        Filename for excel spreadsheet which contains the names and links </span>
<span class="sd">        to all models used in the calculations.</span>
<span class="sd">        </span>
<span class="sd">    file_path : str</span>
<span class="sd">        Defines where the file is being called from.</span>
<span class="sd">        </span>
<span class="sd">    data_folder : str : optional : Default = None</span>
<span class="sd">        The name of the folder where the model_guide can be found and where</span>
<span class="sd">        all of the CMIP data files will downloaded to relative to the file</span>
<span class="sd">        the script is called from. If None, the code will search for the </span>
<span class="sd">        model_guide and download all files to the cwd.</span>
<span class="sd">        </span>
<span class="sd">    world_map : bool : optional : Default = True</span>
<span class="sd">        Displays the latitude-longitude location desired on a world map.</span>
<span class="sd">        Can be useful in double checking the location is selected correctly.</span>
<span class="sd">        </span>
<span class="sd">    calculate_error : bool : optional : Default = True</span>
<span class="sd">        If true, will calculate normalization and distance error for all</span>
<span class="sd">        models. Sighlty faster to run if set to False.</span>
<span class="sd">        </span>
<span class="sd">    display_logging : bool : optional : Default = False</span>
<span class="sd">        If set to True, the logging statements will be printed to the console</span>
<span class="sd">        as well as saved to a file in the current directory.</span>
<span class="sd">        </span>
<span class="sd">    display_plots : bool : optional : Default = True</span>
<span class="sd">        If set to False, the computation for the plotting will be done, but</span>
<span class="sd">        no plots will be shown. Used in unittesting.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat_desired</span><span class="p">,</span> 
                 <span class="n">lon_desired</span><span class="p">,</span>
                 <span class="n">year_baseline</span><span class="p">,</span>
                 <span class="n">year_desired</span><span class="p">,</span>
                 <span class="n">model_guide</span><span class="p">,</span>
                 <span class="n">file_path</span><span class="p">,</span>
                 <span class="n">data_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">scenario_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">,</span><span class="s2">&quot;SSP245&quot;</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">],</span>
                 <span class="n">world_map</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">calculate_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">display_logging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">display_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">data_folder</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()),</span><span class="n">data_folder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">world_map</span> <span class="o">=</span> <span class="n">world_map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">=</span> <span class="n">lat_desired</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">=</span> <span class="n">lon_desired</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span> <span class="o">=</span> <span class="n">year_baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year_desired</span> <span class="o">=</span> <span class="n">year_desired</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_error</span> <span class="o">=</span> <span class="n">calculate_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_guide</span> <span class="o">=</span> <span class="n">model_guide</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_folder</span> <span class="o">=</span> <span class="n">data_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span> <span class="o">=</span> <span class="n">scenario_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_plots</span> <span class="o">=</span> <span class="n">display_plots</span>

        <span class="c1">#Initializing logging</span>
        <span class="k">global</span> <span class="n">logger</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> | </span><span class="si">%(levelname)s</span><span class="s2"> | </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s2">&quot;CMIP6_Data_Log.log&quot;</span><span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">display_logging</span><span class="p">:</span>
            <span class="n">stream_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="n">stream_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">stream_handler</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Script Initiation&quot;</span><span class="p">)</span>
        
        <span class="c1">#Testing Cartopy module import</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">global</span> <span class="n">ccrs</span>
            <span class="k">global</span> <span class="n">cf</span>
            <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
            <span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cf</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_cartopy</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1">#urllib.request.urlretrieve(&quot;https://testingcaseinwhichthisfails&quot;)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Unable to import cartopy&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_cartopy</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="c1">#Checking latitude and longitude inputs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1">#If negative lon is inputted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">+=</span> <span class="mi">360</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">&gt;</span> <span class="mi">360</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Longitude input is out of range&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latitude input is out of range&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_CMIP_Data_Collection</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_CMIP_Data_Collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._CMIP_Data_Collection</span>
<span class="sd">        </span>
<span class="sd">        Downloads all necessary CMIP6 files, performs location and temperature</span>
<span class="sd">        computation, collects temperature change values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">world_map</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_World_map_plotting</span><span class="p">()</span>
        
        <span class="c1">#Downloads necessary files for each scenario</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="p">:</span>
            <span class="n">folder_path</span> <span class="o">=</span> <span class="s2">&quot;CMIP6_Data_Files&quot;</span> 
            <span class="n">model_guide_wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model_guide</span><span class="p">))</span>
            <span class="n">model_guide_ws</span> <span class="o">=</span> <span class="n">model_guide_wb</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span>
            
            <span class="c1">#Creates folders</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">))</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">))</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">))</span>
        
            <span class="c1">#Performs all file downloads with threading</span>
            <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>    
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">model_guide_ws</span><span class="o">.</span><span class="n">max_row</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">link</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="n">file_path_list</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_path_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,</span><span class="n">file_name</span><span class="p">)</span>
                
                <span class="n">t</span> <span class="o">=</span> <span class="n">thr</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_Download_File</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">path</span><span class="p">,</span> <span class="n">link</span><span class="p">])</span>
                <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                <span class="n">threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
                <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All </span><span class="si">{</span><span class="n">scenario</span><span class="si">}</span><span class="s2"> files downloaded&quot;</span><span class="p">)</span>
                    
        <span class="c1">#Runs bulk of calculations with multiprocessing</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">total_model_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="p">:</span>
            <span class="n">total_model_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Compiling_Data</span><span class="p">,(</span><span class="n">model_guide_wb</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,)))</span>
        
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">total_model_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">scenario</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_model_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
          
        <span class="n">model_guide_wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Temperature computation complete&quot;</span><span class="p">)</span>
        
        <span class="c1">#calculates all result statistics used for delT and results1()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_stats</span><span class="p">()</span>
        
        <span class="c1">#Creates dictionary of temperature change results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delT</span> <span class="o">=</span> <span class="p">{</span><span class="n">scenario</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list_reg</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">year_desired</span><span class="o">-</span><span class="mi">2015</span><span class="p">]</span> <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span> <span class="k">if</span> <span class="n">scenario</span> <span class="o">!=</span> <span class="s2">&quot;historical&quot;</span><span class="p">}</span>


    <span class="k">def</span> <span class="nf">_World_map_plotting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._World_map_plotting()</span>
<span class="sd">        </span>
<span class="sd">        Plots selected latitude-longitude point on a world map.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_cartopy</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_plots</span><span class="p">:</span>
            <span class="c1">##### Potting Location for Reference #####</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">stock_img</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="p">],</span>
                     <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                     <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot display world map because cartopy is not properly installed&quot;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">_Download_File</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">link</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._Download_File(path,link)</span>
<span class="sd">        </span>
<span class="sd">        Downloads a file from CMIP6. If errors are encountered, other data </span>
<span class="sd">        nodes will be checked for a duplicate file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Downloading file:&quot;</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span> 
                <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Download failed. Data node is down. Trying again with other nodes&quot;</span><span class="p">)</span>
                <span class="n">all_data_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aims3.llnl.gov&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;cmip.bcc.cma.cn&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;crd-esgf-drc.ec.gc.ca&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;dist.nmlab.snu.ac.kr&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esg.lasg.ac.cn&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esg-cccr.tropmet.res.in&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esg-dn1.nsc.liu.se&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esg-dn2.nsc.liu.se&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf.nci.org.au&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf3.dkrz.de&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf-data.ucar.edu&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf-data1.llnl.gov&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf-data2.diasjp.net&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf-data3.diasjp.net&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;esgf-node2.cmcc.it&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;vesg.ipsl.upmc.fr&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;cmip.dess.tsinghua.edu.cn&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;dpesgf03.nccs.nasa.gov&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">all_data_nodes</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">)</span>
                        <span class="n">link_list</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                        <span class="n">link_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
                        <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">link_list</span><span class="p">)</span>
                        <span class="n">link</span> <span class="o">=</span> <span class="s2">&quot;http://&quot;</span> <span class="o">+</span> <span class="n">link</span>
                        <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">link</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">all_data_nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not download file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
                    
                    
    <span class="k">def</span> <span class="nf">_Compiling_Data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model_guide_wb</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._Compiling_Data(model_guide_wb,folder_path,scenario)</span>
<span class="sd">        </span>
<span class="sd">        Compiles information from all files of a model and stores them as model</span>
<span class="sd">        objects. Then uses Total objects to store all information on the models</span>
<span class="sd">        for a scenario once calculations have been run.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scenario_model_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">model_guide_ws</span> <span class="o">=</span> <span class="n">model_guide_wb</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">model_guide_ws</span><span class="o">.</span><span class="n">max_row</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">model_name</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">file_path_list</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_path_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,</span><span class="n">file_name</span><span class="p">)</span>
            <span class="n">file_count</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">file_num</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">Model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Model_object</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">file_count</span> <span class="o">==</span> <span class="n">file_num</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data_list</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">scenario_model_data</span><span class="p">[</span><span class="n">Model</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Model</span>
                    <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">scenario_model_data</span><span class="p">[</span><span class="n">Model</span><span class="o">.</span><span class="n">name</span><span class="p">],</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
                    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">scenario_model_data</span><span class="p">[</span><span class="n">Model</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Model</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1">#Combines information into Total objects</span>
        <span class="n">Total_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Total_data</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">scenario_model_data</span><span class="p">:</span>
            <span class="n">scenario_model_data</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_yearly_dataset_temps</span><span class="p">(</span><span class="n">scenario_model_data</span><span class="p">[</span><span class="n">model</span><span class="p">],</span><span class="n">Total_obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">:</span>
            <span class="n">Total_obj</span><span class="o">.</span><span class="n">compute_error</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Total_obj</span>


    <span class="k">class</span> <span class="nc">Model_object</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model_object class used for storing information from each model in objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">model</span>
            <span class="n">dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_cftime</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dset</span>
            <span class="c1">#To be set later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">def</span> <span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">start_year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">start_year_list</span> <span class="o">=</span> <span class="n">start_year</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start_year_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">end_year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">end_year_list</span> <span class="o">=</span> <span class="n">end_year</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end_year_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>
            
                    
    <span class="k">class</span> <span class="nc">Total_data</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Total_data class used for storing resulting data from all models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">scenario</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">scenario</span> <span class="o">!=</span> <span class="s2">&quot;historical&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="mi">2015</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span> <span class="o">=</span> <span class="mi">2100</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">year_temp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">new_list</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">new_list</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2101</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">=</span> <span class="mi">1850</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span> <span class="o">=</span> <span class="mi">2014</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">year_temp_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">new_list</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">new_list</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">)}</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">scenario</span> <span class="o">=</span> <span class="n">scenario</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_error_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">num_years</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_year</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_year</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delT_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_years</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CI_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_years</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delT_list_reg</span> <span class="o">=</span> <span class="kc">None</span>
            
        <span class="k">def</span> <span class="nf">compute_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">avg_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg_error_list</span><span class="p">)</span>
            
            
    <span class="k">def</span> <span class="nf">_yearly_dataset_temps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model_object</span><span class="p">,</span><span class="n">total_object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._yearly_dataset_temps(model_object,total_object)</span>
<span class="sd">        </span>
<span class="sd">        Calculates average yearly temperature value for the specific location</span>
<span class="sd">        input using 2-point interpolation and error calcualtions. Stores output</span>
<span class="sd">        data in the total scenario object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_tas</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">data</span>
        <span class="n">start_year</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">start_year</span>
        <span class="n">end_year</span> <span class="o">=</span> <span class="n">model_object</span><span class="o">.</span><span class="n">end_year</span>
        <span class="n">local_max_diff</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_max_diff</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start_year</span><span class="p">,</span><span class="n">end_year</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">end_year</span><span class="o">-</span><span class="n">start_year</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">year_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">end_year</span><span class="o">-</span><span class="n">start_year</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">mon_temp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">12</span>
            <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data_tas</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">years</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span><span class="o">-</span><span class="n">start_year</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="o">+</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">lon_data_coords</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">lat_data_coords</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                
                <span class="c1">#Run for first month of the first year because location does not change</span>
                <span class="k">if</span> <span class="n">month</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">year_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    
                    <span class="c1">#Checks if the latitude input is in range of the Global Climate Model grid</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">&lt;=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">&gt;=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latitude input is out of range of GCM&quot;</span><span class="p">)</span>
                    
                    <span class="c1">#Setting Arbitrary grid points if lon&lt;358.5</span>
                    <span class="n">lon_grid_coords_1</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">lon_grid_coords_2</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
                    <span class="c1">#Finding the coords of the closest grid points</span>
                    <span class="n">lon_init</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">delta_lon</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lon_init</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">-</span> <span class="n">lon_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span><span class="p">)</span>
                
                    <span class="n">lat_init</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">delta_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_data_coords</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
                    
                <span class="c1">#Finding distances from the grid points</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lon_data_coords</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#Accounting for Longitude Wrapping</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                 
                <span class="n">lon_grid_coords_1</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="n">lon_grid_coords_2</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span> <span class="o">&gt;=</span> <span class="mi">300</span><span class="p">:</span> <span class="c1">#For data points that are in between [-1] and [0] on the left of lon = 0</span>
                    <span class="n">diff_lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_grid_coords_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lon_grid_coords_1</span> <span class="o">-</span> <span class="mi">360</span><span class="p">))</span>
                    <span class="n">grid_lon_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="o">-</span><span class="n">lon_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">diff_lon</span>
                <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#For data points that are in between [-1] and [0] on the right of lon = 0</span>
                    <span class="n">diff_lon</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_grid_coords_2</span> <span class="o">-</span> <span class="p">(</span><span class="n">lon_grid_coords_1</span> <span class="o">-</span> <span class="mi">360</span><span class="p">))</span>
                    <span class="n">grid_lon_mult</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">lon_grid_coords_2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="p">)</span><span class="o">/</span><span class="n">diff_lon</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grid_lon_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="o">-</span><span class="n">lon_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span>
                
                <span class="n">lat_grid_coords_1</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                <span class="n">grid_lat_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span><span class="o">-</span><span class="n">lat_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span>
                
                <span class="k">if</span> <span class="n">grid_lat_mult</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">delta_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_data_coords</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
                    <span class="n">lat_grid_coords_1</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                    <span class="n">grid_lat_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span><span class="o">-</span><span class="n">lat_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span>
                    
                <span class="c1">#Location Error</span>
                <span class="k">if</span> <span class="n">month</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">year_index</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">:</span>

                    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">0.5</span><span class="o">-</span><span class="n">grid_lon_mult</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">-</span><span class="n">grid_lat_mult</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="n">dist_error</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span><span class="o">*</span><span class="n">dist</span>
                    
                    <span class="c1">#Normalization Error Boundaries.Set for the US</span>
                    <span class="n">US_1_lon</span><span class="p">,</span> <span class="n">US_1_lat</span> <span class="o">=</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">25</span>
                    <span class="n">US_1_x</span><span class="p">,</span><span class="n">US_1_y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">US_1_lon</span> <span class="o">-</span> <span class="n">lon_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">US_1_lat</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
    
                    <span class="n">US_4_lon</span><span class="p">,</span> <span class="n">US_4_lat</span> <span class="o">=</span> <span class="mi">295</span><span class="p">,</span> <span class="mi">50</span>
                    <span class="n">US_4_x</span><span class="p">,</span><span class="n">US_4_y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">US_4_lon</span> <span class="o">-</span> <span class="n">lon_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">US_4_lat</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
                    
                <span class="c1">#Establishing temperature values for the 4 surrounding grid points</span>
                <span class="n">temp_1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="n">temp_2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="n">temp_3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="n">temp_4</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>     
                
                <span class="c1">#Normalization Error</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">:</span>
                    <span class="n">US_temp_array</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">US_1_y</span><span class="p">:</span><span class="n">US_4_y</span><span class="p">,</span><span class="n">US_1_x</span><span class="p">:</span><span class="n">US_4_x</span><span class="p">]</span> <span class="c1">#[rows,cols] -&gt; [y,x]   </span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">US_temp_array</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="n">total_max_diff</span><span class="p">:</span>
                        <span class="n">total_max_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">US_temp_array</span><span class="p">)))</span> 
                    <span class="n">US_temp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">US_temp_array</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">US_temp_array</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="n">total_max_diff</span><span class="p">:</span>
                        <span class="n">total_max_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">US_temp_array</span><span class="p">)))</span>
                        
                    <span class="c1">#local Normalization Error</span>
                    <span class="n">local_temp_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">temp_1</span><span class="o">-</span><span class="n">temp_2</span><span class="p">,</span><span class="n">temp_1</span><span class="o">-</span><span class="n">temp_3</span><span class="p">,</span><span class="n">temp_3</span><span class="o">-</span><span class="n">temp_4</span><span class="p">,</span><span class="n">temp_2</span><span class="o">-</span><span class="n">temp_4</span><span class="p">])))</span>
                    <span class="k">if</span> <span class="n">local_temp_diff</span> <span class="o">&gt;</span> <span class="n">local_max_diff</span><span class="p">:</span>
                        <span class="n">local_max_diff</span> <span class="o">=</span> <span class="n">local_temp_diff</span>
                
                <span class="n">temp_inter_1</span> <span class="o">=</span> <span class="n">temp_1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lon_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_2</span><span class="o">*</span><span class="n">grid_lon_mult</span>
                <span class="n">temp_inter_2</span> <span class="o">=</span> <span class="n">temp_3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lon_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_4</span><span class="o">*</span><span class="n">grid_lon_mult</span>
                <span class="n">temp_des</span> <span class="o">=</span> <span class="n">temp_inter_1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lat_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_inter_2</span><span class="o">*</span><span class="n">grid_lat_mult</span>
                
                <span class="n">mon_temp</span><span class="p">[</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_des</span>
            
            <span class="n">yearly_avg_temp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">mon_temp</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span>
            <span class="k">if</span> <span class="n">years</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1850</span> <span class="ow">and</span> <span class="n">years</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2014</span><span class="p">:</span> <span class="k">continue</span> <span class="c1">#Skipping years past 2014 for some historical data sets for consistency</span>
            <span class="n">total_object</span><span class="o">.</span><span class="n">year_temp_dict</span><span class="p">[</span><span class="n">years</span><span class="p">[</span><span class="n">year_index</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yearly_avg_temp</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_error</span><span class="p">:</span>
            <span class="n">norm_factor</span> <span class="o">=</span><span class="n">local_max_diff</span><span class="o">/</span><span class="n">total_max_diff</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">dist_error</span><span class="o">*</span><span class="n">norm_factor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">model_object</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
        <span class="n">total_object</span><span class="o">.</span><span class="n">avg_error_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">_calculate_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._calculate_stats()</span>
<span class="sd">        </span>
<span class="sd">        Calculates ensemble means and 95% confidence interval bounds for the </span>
<span class="sd">        total temperature data of each scenario, then performs a fixed point</span>
<span class="sd">        regression on all data to produce useable results. The regressed data</span>
<span class="sd">        is later outputted as results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">historical_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">future_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2101</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
        <span class="n">historical_averaged_temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">year_temp_dict</span><span class="p">[</span><span class="n">year</span><span class="p">])</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">historical_years</span><span class="p">]</span>
        
        <span class="c1">#Sets fixed point at 2015</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">future_years</span><span class="p">)</span>
        <span class="n">sigma</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.001</span>
        
        <span class="k">def</span> <span class="nf">poly_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">p</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="c1">#Calculates regressed historical data for baseline calculation</span>
        <span class="n">baseline_polynomial</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">poly_function</span><span class="p">,</span> <span class="n">historical_years</span><span class="p">,</span> <span class="n">historical_averaged_temps</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">baseline_polynomial</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span><span class="p">)</span>
        <span class="n">scenario_transition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">baseline_polynomial</span><span class="p">)(</span><span class="mi">2015</span><span class="p">)</span>
        
        <span class="c1">#Calculates regressed histroical data again, but with the baseline offset</span>
        <span class="n">historical_averaged_temps_baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">historical_averaged_temps</span><span class="p">)</span> <span class="o">-</span> <span class="n">baseline</span>
        <span class="n">historical_polynomial</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">poly_function</span><span class="p">,</span> <span class="n">historical_years</span><span class="p">,</span> <span class="n">historical_averaged_temps_baseline</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">historical_regression</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">historical_polynomial</span><span class="p">)(</span><span class="n">historical_years</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list_reg</span> <span class="o">=</span> <span class="n">historical_regression</span>
        
        <span class="k">for</span> <span class="n">year_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">historical_years</span><span class="p">)):</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">year_temp_dict</span><span class="p">[</span><span class="n">historical_years</span><span class="p">[</span><span class="n">year_index</span><span class="p">]]</span> <span class="o">-</span> <span class="n">baseline</span>
            <span class="n">delT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> 
            <span class="n">lower_proj</span><span class="p">,</span> <span class="n">upper_proj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
            <span class="n">CI</span> <span class="o">=</span> <span class="n">upper_proj</span> <span class="o">-</span> <span class="n">delT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">CI_list</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">CI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="s2">&quot;historical&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">delT</span>
        
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="s2">&quot;historical&quot;</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">averaged_temps</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">year_temp_dict</span><span class="p">[</span><span class="n">year</span><span class="p">])</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">future_years</span><span class="p">]</span>
            <span class="n">averaged_temps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">scenario_transition</span>
            <span class="n">averaged_temps_delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">averaged_temps</span><span class="p">)</span> <span class="o">-</span> <span class="n">baseline</span>
            <span class="n">polynomial</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">poly_function</span><span class="p">,</span> <span class="n">future_years</span><span class="p">,</span> <span class="n">averaged_temps_delta</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
            <span class="n">regression</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">polynomial</span><span class="p">)(</span><span class="n">future_years</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list_reg</span> <span class="o">=</span> <span class="n">regression</span>
            
            <span class="k">for</span> <span class="n">year_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">future_years</span><span class="p">)):</span>
                <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">year_temp_dict</span><span class="p">[</span><span class="n">future_years</span><span class="p">[</span><span class="n">year_index</span><span class="p">]]</span> <span class="o">-</span> <span class="n">baseline</span>
                <span class="n">delT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
                <span class="n">lower_proj</span><span class="p">,</span> <span class="n">upper_proj</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
                <span class="n">CI</span> <span class="o">=</span> <span class="n">upper_proj</span> <span class="o">-</span> <span class="n">delT</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">CI_list</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">CI</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list</span><span class="p">[</span><span class="n">year_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">delT</span>
                

<div class="viewcode-block" id="CMIP_Data.results1"><a class="viewcode-back" href="../../../mews.data_requests.CMIP6.html#mews.data_requests.CMIP6.CMIP_Data.results1">[docs]</a>    <span class="k">def</span> <span class="nf">results1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">scatter_display</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">],</span><span class="n">regression_display</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span><span class="n">CI_display</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the temperature change values for the scenarios for the years 1950-2100.</span>

<span class="sd">        &gt;&gt;&gt; obj.results1(scatter_display=[False,False,False,False,False,False],</span>
<span class="sd">                         regression_display=[True,True,True,True,True,True],</span>
<span class="sd">                         CI_display=[True,False,True,False,True,False])</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        scatter_display : bool : list : optional : Default = [False,False,False,False,False,False]</span>
<span class="sd">            A list of 6 boolean values used for selecting which scatter data to plot.</span>
<span class="sd">            The list items correspond to: historical, SSP119, SSP126, SSP245, SSP370, SSP585.</span>
<span class="sd">            </span>
<span class="sd">        regression_display : bool : list : optional : Default = [True,True,True,True,True,True]</span>
<span class="sd">            A list of 6 boolean values used for selecting which regressions to plot.</span>
<span class="sd">            The list items correspond to: historical, SSP119, SSP126, SSP245, SSP370, SSP585.</span>
<span class="sd">            </span>
<span class="sd">        CI_display : bool : list : optional : Default = [True,False,True,False,True,False]</span>
<span class="sd">            A list of 6 boolean values used for selecting which Confidence intervals to plot.</span>
<span class="sd">            The list items correspond to: historical, SSP119, SSP126, SSP245, SSP370, SSP585.            </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_plots</span><span class="p">:</span> 
            <span class="n">historical_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1850</span><span class="p">,</span><span class="mi">2015</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">future_years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2101</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            
            <span class="c1">#years, colors, and labels organized into dictionaries for succinctness</span>
            <span class="n">year_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">:</span><span class="n">historical_years</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">:</span><span class="n">future_years</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">:</span><span class="n">future_years</span><span class="p">,</span><span class="s2">&quot;SSP245&quot;</span><span class="p">:</span><span class="n">future_years</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">:</span><span class="n">future_years</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">:</span><span class="n">future_years</span><span class="p">}</span>
            <span class="n">color_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">:</span><span class="s2">&quot;k&quot;</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">:</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">:</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span><span class="s2">&quot;SSP245&quot;</span><span class="p">:</span><span class="s2">&quot;gold&quot;</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">:</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">:</span><span class="s2">&quot;maroon&quot;</span><span class="p">}</span>
            <span class="n">scatter_label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged Historical Data&quot;</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged SSP1-1.9 Data&quot;</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged SSP1-2.6 Data&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;SSP245&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged SSP2-4.5 Data&quot;</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged SSP3.70 Data&quot;</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">:</span><span class="s2">&quot;Averaged SSP5-8.5 Data&quot;</span><span class="p">}</span>
            <span class="n">regression_label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">:</span><span class="s2">&quot;Historical Regression&quot;</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">:</span><span class="s2">&quot;SSP1-1.9 Regression&quot;</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">:</span><span class="s2">&quot;SSP1-2.6 Regression&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;SSP245&quot;</span><span class="p">:</span><span class="s2">&quot;SSP2-4.5 Regression&quot;</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">:</span><span class="s2">&quot;SSP3.70 Regression&quot;</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">:</span><span class="s2">&quot;SSP5-8.5 Regression&quot;</span><span class="p">}</span>
            <span class="n">CI_label_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;historical&quot;</span><span class="p">:</span><span class="s2">&quot;Historical Data 95% CI&quot;</span><span class="p">,</span><span class="s2">&quot;SSP119&quot;</span><span class="p">:</span><span class="s2">&quot;SSP1-1.9 Data 95% CI&quot;</span><span class="p">,</span><span class="s2">&quot;SSP126&quot;</span><span class="p">:</span><span class="s2">&quot;SSP1-2.6 Data 95% CI&quot;</span><span class="p">,</span>
                             <span class="s2">&quot;SSP245&quot;</span><span class="p">:</span><span class="s2">&quot;SSP2-4.5 Data 95% CI&quot;</span><span class="p">,</span><span class="s2">&quot;SSP370&quot;</span><span class="p">:</span><span class="s2">&quot;SSP3.70 Data 95% CI&quot;</span><span class="p">,</span><span class="s2">&quot;SSP585&quot;</span><span class="p">:</span><span class="s2">&quot;SSP5-8.5 Data 95% CI&quot;</span><span class="p">}</span>
    
            <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">scenario</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">scatter_display</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">year_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">color_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">scatter_label_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">regression_display</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list_reg</span><span class="p">,</span><span class="n">color_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">regression_label_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">CI_display</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">year_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">CI_list</span><span class="p">),</span>
                                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">delT_list</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">total_model_data</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span><span class="o">.</span><span class="n">CI_list</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="n">color_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">CI_label_dict</span><span class="p">[</span><span class="n">scenario</span><span class="p">])</span>
                
            <span class="n">plot_box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">plot_box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">plot_box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="n">plot_box</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span><span class="n">plot_box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">})</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;°C Change&quot;</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">26</span><span class="p">})</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Surface Temperature Change at (</span><span class="si">{0:.5f}</span><span class="s2">, </span><span class="si">{1:.5f}</span><span class="s2">) Relative to </span><span class="si">{2:.0f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat_desired</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">lon_desired</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1950</span><span class="p">,</span><span class="mi">2100</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
    
<div class="viewcode-block" id="CMIP_Data.results2"><a class="viewcode-back" href="../../../mews.data_requests.CMIP6.html#mews.data_requests.CMIP6.CMIP_Data.results2">[docs]</a>    <span class="k">def</span> <span class="nf">results2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">desired_scenario</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the temperature change heat map of the United States from year_baseline</span>
<span class="sd">        to year_desired for a selected scenario.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; obj.results2(desired_scenario,</span>
<span class="sd">                         resolution=&#39;low&#39;)</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        desired_scenario : str </span>
<span class="sd">            A str that selectes the future scenario heat map that will be calculated and</span>
<span class="sd">            displayed. The possible strings are: &quot;SSP119&quot;, &quot;SSP126&quot;, &quot;SSP245&quot;, &quot;SSP370&quot;, &quot;SSP585&quot;.</span>
<span class="sd">            Any other strings will return an error.</span>
<span class="sd">            </span>
<span class="sd">        resolution : str : optional : Default = &#39;low&#39;</span>
<span class="sd">            A string that selectes the resolution of the heat map plotted. The default </span>
<span class="sd">            setting is low so the simulation can be run quicker. Higher qualities can</span>
<span class="sd">            take much longer to calculate and display. All possible resolutions are:</span>
<span class="sd">            &quot;low&quot;, &quot;medium&quot;, &quot;high&quot;, &quot;extreme&quot;. &quot;test&quot; is very inaccurate; only used for</span>
<span class="sd">            unittesting.</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">resolution_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;test&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="s2">&quot;low&quot;</span><span class="p">:[</span><span class="mi">60</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span><span class="s2">&quot;medium&quot;</span><span class="p">:[</span><span class="mi">120</span><span class="p">,</span><span class="mi">54</span><span class="p">],</span><span class="s2">&quot;high&quot;</span><span class="p">:[</span><span class="mi">240</span><span class="p">,</span><span class="mi">108</span><span class="p">],</span><span class="s2">&quot;extreme&quot;</span><span class="p">:[</span><span class="mi">480</span><span class="p">,</span><span class="mi">216</span><span class="p">]}</span>
 
        <span class="n">lon_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="mi">66</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">resolution_dict</span><span class="p">[</span><span class="n">resolution</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">lat_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">resolution_dict</span><span class="p">[</span><span class="n">resolution</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="s2">&quot;CMIP6_Data_Files&quot;</span> 
        
        <span class="n">result_arrays</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;historical&#39;</span><span class="p">,</span><span class="n">desired_scenario</span><span class="p">]:</span>
            <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span> <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="s1">&#39;historical&#39;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_desired</span>
    
            
            <span class="n">model_guide_wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model_guide</span><span class="p">))</span>
            <span class="n">model_guide_ws</span> <span class="o">=</span> <span class="n">model_guide_wb</span><span class="p">[</span><span class="n">scenario</span><span class="p">]</span>
        
            <span class="n">model_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">model_guide_ws</span><span class="o">.</span><span class="n">max_row</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">:</span>
                    <span class="n">model_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    
            <span class="n">pool</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">temp_array_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">:</span>
                <span class="n">temp_array_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results2_calc</span><span class="p">,(</span><span class="n">model_guide_ws</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">lat_array</span><span class="p">,</span><span class="n">lon_array</span><span class="p">,</span><span class="n">year</span><span class="p">)))</span>
            <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_array_list</span><span class="p">)):</span>
                <span class="n">temp_array_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_array_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        
            <span class="n">array</span> <span class="o">=</span> <span class="n">temp_array_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">)):</span>
                    <span class="n">array</span>  <span class="o">+=</span> <span class="n">temp_array_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">)</span>
            <span class="n">result_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">result_arrays</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">],</span><span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">lat_array</span><span class="p">,</span><span class="n">lon_array</span><span class="p">])</span>
        <span class="n">projection</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">result_arrays</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">],</span><span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">lat_array</span><span class="p">,</span><span class="n">lon_array</span><span class="p">])</span>
        <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">projection</span> <span class="o">-</span> <span class="n">baseline</span>

        <span class="n">value_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">delta_temp</span><span class="p">)</span>
        <span class="n">value_low</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">delta_temp</span><span class="p">))</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">value_high</span><span class="p">),</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">value_low</span><span class="p">)])</span>

        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">46</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_plots</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_cartopy</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
                <span class="n">delta_temp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="n">limit</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cf</span><span class="o">.</span><span class="n">STATES</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;US Temperature Change from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year_desired</span><span class="si">}</span><span class="s2"> According to </span><span class="si">{</span><span class="n">desired_scenario</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span><span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot display US borders because cartopy is not properly installed&quot;</span><span class="p">)</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_array</span><span class="p">,</span> <span class="n">lat_array</span><span class="p">,</span> <span class="n">delta_temp</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">limit</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;pcolormesh&#39;</span><span class="p">)</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude [Degrees North]&quot;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude [Degrees East]&quot;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">235</span><span class="p">,</span><span class="mi">294</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;US Temperature Change from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year_baseline</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">year_desired</span><span class="si">}</span><span class="s2"> According to </span><span class="si">{</span><span class="n">desired_scenario</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

            
    <span class="k">def</span> <span class="nf">_results2_calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model_guide_ws</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">lat_array</span><span class="p">,</span><span class="n">lon_array</span><span class="p">,</span><span class="n">year</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj._results2_calc(model_guide_ws,</span>
<span class="sd">                           folder_path,</span>
<span class="sd">                           scenario,</span>
<span class="sd">                           model,</span>
<span class="sd">                           lat_array,</span>
<span class="sd">                           lon_array,</span>
<span class="sd">                           year)</span>
<span class="sd">        </span>
<span class="sd">        Performs all of the calculations associated with plotting the US heat maps</span>
<span class="sd">        in the function call obj.results2(desired_scenario, resolution). First, it</span>
<span class="sd">        compiles the data used, then computes the temperature change grid array, </span>
<span class="sd">        and finally returns that data to results2.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">model_guide_ws</span><span class="o">.</span><span class="n">max_row</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">model_name</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">link</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="n">file_path_list</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_path_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirname</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">scenario</span><span class="p">,</span><span class="n">file_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model_name</span> <span class="o">==</span> <span class="n">model</span><span class="p">:</span>
                <span class="n">Model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Model_object</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span><span class="n">path</span><span class="p">)</span>
                <span class="n">file_count</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="n">file_num</span> <span class="o">=</span> <span class="n">model_guide_ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                <span class="k">if</span> <span class="n">file_count</span> <span class="o">==</span> <span class="n">file_num</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">data_list</span> <span class="o">!=</span> <span class="p">[]:</span>
                        <span class="n">Complete_model</span> <span class="o">=</span> <span class="n">Model</span>
                        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">Complete_model</span><span class="p">,</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">Complete_model</span> <span class="o">=</span> <span class="n">Model</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        
        <span class="n">Complete_model</span><span class="o">.</span><span class="n">set_data</span><span class="p">()</span>
        <span class="n">temperature_baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_array</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">lon_array</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_array</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lon_array</span><span class="p">)):</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="n">lat_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">lon</span> <span class="o">=</span> <span class="n">lon_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            
                <span class="n">mon_temp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">12</span>
                <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">Complete_model</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">year</span><span class="o">-</span><span class="n">Complete_model</span><span class="o">.</span><span class="n">start_year</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span><span class="o">+</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">lon_data_coords</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                    <span class="n">lat_data_coords</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

                    <span class="k">if</span> <span class="n">month</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">lon_init</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">delta_lon</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lon_init</span>
                        <span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">lon</span> <span class="o">-</span> <span class="n">lon_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span><span class="p">)</span>
                    
                        <span class="n">lat_init</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">delta_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_data_coords</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">lat</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
   
                    <span class="n">lon_grid_coords_1</span> <span class="o">=</span> <span class="n">lon_data_coords</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                    <span class="n">grid_lon_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lon</span><span class="o">-</span><span class="n">lon_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lon</span>
                    <span class="n">lat_grid_coords_1</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                    <span class="n">grid_lat_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lat</span><span class="o">-</span><span class="n">lat_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span>
                    
                    <span class="k">if</span> <span class="n">grid_lat_mult</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">delta_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat_data_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lat_data_coords</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">lat</span> <span class="o">-</span> <span class="n">lat_init</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span><span class="p">)</span>
                        <span class="n">lat_grid_coords_1</span> <span class="o">=</span> <span class="n">lat_data_coords</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
                        <span class="n">grid_lat_mult</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lat</span><span class="o">-</span><span class="n">lat_grid_coords_1</span><span class="p">)</span><span class="o">/</span><span class="n">delta_lat</span>
                        
                    <span class="c1">#Establishing temperature values for the 4 surrounding grid points</span>
                    <span class="n">temp_1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">temp_2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">temp_3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">temp_4</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>     
                
                    <span class="n">temp_inter_1</span> <span class="o">=</span> <span class="n">temp_1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lon_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_2</span><span class="o">*</span><span class="n">grid_lon_mult</span>
                    <span class="n">temp_inter_2</span> <span class="o">=</span> <span class="n">temp_3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lon_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_4</span><span class="o">*</span><span class="n">grid_lon_mult</span>
                    <span class="n">temp_des</span> <span class="o">=</span> <span class="n">temp_inter_1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">grid_lat_mult</span><span class="p">)</span> <span class="o">+</span> <span class="n">temp_inter_2</span><span class="o">*</span><span class="n">grid_lat_mult</span>
                    
                    <span class="n">mon_temp</span><span class="p">[</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_des</span>
                <span class="n">yearly_avg_temp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">mon_temp</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span>
                <span class="n">temperature_baseline</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">yearly_avg_temp</span>
                
        <span class="k">return</span> <span class="n">temperature_baseline</span></div>

        

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1">#Test Code: example ran in examples/CMIP_data</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">CMIP_Data</span><span class="p">(</span><span class="n">lat_desired</span> <span class="o">=</span> <span class="mf">35.0433</span><span class="p">,</span>
                    <span class="n">lon_desired</span> <span class="o">=</span> <span class="o">-</span><span class="mf">106.6129</span><span class="p">,</span>
                    <span class="n">year_baseline</span> <span class="o">=</span> <span class="mi">2014</span><span class="p">,</span>
                    <span class="n">year_desired</span> <span class="o">=</span> <span class="mi">2050</span><span class="p">,</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()),</span>
                    <span class="n">model_guide</span> <span class="o">=</span> <span class="s2">&quot;Models_Used_Simplified.xlsx&quot;</span><span class="p">,</span>
                    <span class="n">calculate_error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">world_map</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">display_logging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">display_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">results1</span><span class="p">(</span><span class="n">scatter_display</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">results2</span><span class="p">(</span><span class="n">desired_scenario</span> <span class="o">=</span> <span class="s2">&quot;SSP119&quot;</span><span class="p">,</span><span class="n">resolution</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">)</span>

    <span class="c1">#print(&quot;Program run time: {0:.3f} seconds&quot;.format(time.time() - start_time))</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Cities chosen based on climate zones</span>
<span class="sd">Miami lat: 25.7881 Lon: -80.31694</span>
<span class="sd">Houston lat: 29.9844 lon: -95.36072</span>
<span class="sd">Phooenix lat: 33.4278 lon: -112.0037</span>
<span class="sd">Atlanta lat: 33.6297 lon: -84.44224</span>
<span class="sd">Los Angeles lat: 33.9382 lon: -118.3866</span>
<span class="sd">Las Vegas lat: 36.2121 lon: -115.1939</span>
<span class="sd">San Francisco lat: 37.6196 lon: -122.3656</span>
<span class="sd">Baltimore lat: 39.1733 lon: -76.68408</span>
<span class="sd">Albuquerque lat: 35.0433 lon: -106.6129</span>
<span class="sd">Seattle lat: 47.4447 lon: -122.3144</span>
<span class="sd">Chicago lat: 41.7841 lon: -87.75514</span>
<span class="sd">Denver lat: 39.8466 lon: -104.6562</span>
<span class="sd">Minneapolis lat: 44.8852 lon: -93.23133</span>
<span class="sd">Helena lat: 46.6044 lon: -111.9892</span>
<span class="sd">Duluth lat: 46.8436 lon: -92.18658</span>
<span class="sd">Fairbanks lat: 64.8031 lon: -147.8761</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, National Technology and Engineering Solutions of Sandia, LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>