<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mews.weather.doe2weather &mdash; MEWS 0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> MEWS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MEWS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>mews.weather.doe2weather</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for mews.weather.doe2weather</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Jul  1 10:26:52 2021</span>

<span class="sd">@author: dlvilla</span>


<span class="sd">Created on Tue Apr 20 14:50:39 2021</span>

<span class="sd">Copyright Notice</span>
<span class="sd">=================</span>

<span class="sd">Copyright 2021 National Technology and Engineering Solutions of Sandia, LLC. </span>
<span class="sd">Under the terms of Contract DE-NA0003525, there is a non-exclusive license </span>
<span class="sd">for use of this work by or on behalf of the U.S. Government. </span>
<span class="sd">Export of this program may require a license from the </span>
<span class="sd">United States Government.</span>

<span class="sd">Please refer to the LICENSE.md file for a full description of the license</span>
<span class="sd">terms for MEWS. </span>

<span class="sd">The license for MEWS is the Modified BSD License and copyright information</span>
<span class="sd">must be replicated in any derivative works that use the source code.</span>

<span class="sd">@author: dlvilla</span>

<span class="sd">MEWS = Multi-senario Extreme Weather Simulator</span>

<span class="sd">METHODS   mews.weather.DOE2Weather.read_doe2_bin and  </span>
<span class="sd">          mews.weather.DOE2Weather.write_doe2_bin</span>
<span class="sd"> </span>
<span class="sd">   Are translations of parts of BIN2TXT.F and TXT2BIN.F translated with permission</span>
<span class="sd">   from James and Jeff Hirsch and Associates (JJH&amp;A). The license for these utilities </span>
<span class="sd">   must be formed with (JJH&amp;A) before they are distributed in any other package</span>
<span class="sd">   besides MEWS</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span><span class="p">,</span><span class="n">cumsum</span><span class="p">,</span><span class="n">arange</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">float64</span><span class="p">,</span><span class="n">array</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">chdir</span> <span class="k">as</span> <span class="n">cd</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">remove</span> <span class="k">as</span> <span class="n">rm</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getcwd</span> <span class="k">as</span> <span class="n">pwd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copy</span> <span class="k">as</span> <span class="n">cp</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">DatetimeIndex</span><span class="p">,</span> <span class="n">DateOffset</span><span class="p">,</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">struct</span>

<div class="viewcode-block" id="DataFormats"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DataFormats">[docs]</a><span class="k">class</span> <span class="nc">DataFormats</span><span class="p">():</span>
    <span class="c1"># changing this will cause significant portions of the code to fail</span>
    <span class="n">header_dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">,</span><span class="s1">&#39;a20&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;year_IWYR&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;latitude_WLAT&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;longitude_WLONG&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;timezone_IWTZN&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;record_length_LRECX&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;number_days_NUMDAY&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;clearness_number_CLN_IM1&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;ground_temperature_GT_IM1&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;solar_flag_IWSOL&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">)])</span>
    <span class="n">column_description</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MONTH (1-12)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DAY OF MONTH&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HOUR OF DAY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;WET BULB TEMP (DEG F)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DRY BULB TEMP (DEG F)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PRESSURE (INCHES OF HG)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CLOUD AMOUNT (0 - 10)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SNOW FLAG (1 = SNOWFALL)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;RAIN FLAG (1 = RAINFALL)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;WIND DIRECTION (0 - 15; 0=N, 1=NNE, ETC)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;HUMIDITY RATIO (LB H2O/LB AIR)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DENSITY OF AIR (LB/CU FT)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;SPECIFIC ENTHALPY (BTU/LB)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;TOTAL HOR. SOLAR (BTU/HR-SQFT)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DIR. NORMAL SOLAR (BTU/HR-SQFT)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CLOUD TYPE (0 - 2)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;WIND SPEED (KNOTS)&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DOE2_Weather_Error"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2_Weather_Error">[docs]</a><span class="k">class</span> <span class="nc">DOE2_Weather_Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">error_message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">=</span> <span class="n">error_message</span></div>

<div class="viewcode-block" id="DOE2Weather"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather">[docs]</a><span class="k">class</span> <span class="nc">DOE2Weather</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">column_description</span> <span class="o">=</span> <span class="n">DataFormats</span><span class="o">.</span><span class="n">column_description</span>
    
    <span class="k">def</span> <span class="nf">_rm_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filenamepath</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">filenamepath</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rm</span><span class="p">(</span><span class="n">filenamepath</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;The operating system will not allow python to remove the &quot;</span> <span class="o">+</span>
                            <span class="n">filenamepath</span> <span class="o">+</span> <span class="s2">&quot; file!&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="DOE2Weather.bin2txt"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.bin2txt">[docs]</a>    <span class="k">def</span> <span class="nf">bin2txt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">binfilename</span><span class="p">,</span><span class="n">bin2txtpath</span><span class="p">):</span>
        <span class="n">txtfilename</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">bin2txtpath</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isfile</span><span class="p">(</span><span class="n">binfilename</span><span class="p">):</span>
            <span class="n">curdir</span> <span class="o">=</span> <span class="n">pwd</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cd</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">bin2txtpath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">binfilename</span><span class="p">):</span>
                    <span class="n">binfilename2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span><span class="n">binfilename</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">binfilename2</span> <span class="o">=</span> <span class="n">binfilename</span>
                <span class="n">cp</span><span class="p">(</span><span class="n">binfilename2</span><span class="p">,</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">)</span>
                    
                <span class="c1"># no arguments needed</span>
                <span class="n">pp</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="n">bin2txtpath</span><span class="p">),</span><span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">output</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;WARNING! An error was recorded by Popen.communicate but this does not mean the BIN2TXT did not work. Investigate further to verify it worked.&quot;</span><span class="p">)</span>
                <span class="n">txtfilename</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">binfilename2</span><span class="p">)</span> <span class="p">,</span> <span class="n">basename</span><span class="p">(</span><span class="n">binfilename2</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
                <span class="n">cp</span><span class="p">(</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">,</span><span class="n">txtfilename</span><span class="p">)</span>
                <span class="n">cd</span><span class="p">(</span><span class="n">curdir</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1"># return to the correct directory</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">cd</span><span class="p">(</span><span class="n">curdir</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;The bin to text process failed!&quot;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;The OS will not allow return to the original directory. &quot;</span> <span class="o">+</span> <span class="n">curdir</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isfile</span><span class="p">(</span><span class="n">bin2txtpath</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;doe2bin2txt.conver_bin_to_txt: the requested bin2txtpath&quot;</span> <span class="o">+</span> 
                        <span class="s2">&quot; executable does not exist! A valid path to the BIN2TXT.EXE&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot; utility must be provided.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;doe2bin2txt.conver_bin_to_txt: the requested binfilename&quot;</span> <span class="o">+</span> 
                        <span class="s2">&quot; does not exist! A valid path to a valid DOE2 weather binary&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot; file must be provided.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">txtfilename</span></div>
    
    
<div class="viewcode-block" id="DOE2Weather.txt2bin"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.txt2bin">[docs]</a>    <span class="k">def</span> <span class="nf">txt2bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">txtfilename</span><span class="p">,</span><span class="n">txt2binpath</span><span class="p">,</span><span class="n">binfilename</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">txt2binpath</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isfile</span><span class="p">(</span><span class="n">txtfilename</span><span class="p">):</span>
            <span class="n">curdir</span> <span class="o">=</span> <span class="n">pwd</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">change_dir</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">txt2binpath</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">change_dir</span><span class="p">:</span>
                    <span class="n">cd</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">txt2binpath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">txtfilename</span> <span class="o">!=</span> <span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">:</span>
                   <span class="n">cp</span><span class="p">(</span><span class="n">txtfilename</span><span class="p">,</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">)</span>
                <span class="c1"># no arguments needed</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">basename</span><span class="p">(</span><span class="n">txt2binpath</span><span class="p">),</span><span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">output</span><span class="p">,</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The process produced an error make sure the process worked!</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
                <span class="n">cp</span><span class="p">(</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">,</span><span class="n">binfilename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">)</span>
                <span class="n">cd</span><span class="p">(</span><span class="n">curdir</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="c1"># return to the correct directory</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">cd</span><span class="p">(</span><span class="n">curdir</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;The OS will not allow return to the original directory.</span><span class="se">\n\n</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="n">curdir</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isfile</span><span class="p">(</span><span class="n">txt2binpath</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;doe2bin2txt.txt2bin: the requested bin2txtpath&quot;</span> <span class="o">+</span> 
                        <span class="s2">&quot; executable does not exist! A valid path to the TXT2BIN.EXE&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot; utility must be provided.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;doe2bin2txt.txt2bin: the requested txtfilename&quot;</span> <span class="o">+</span> 
                        <span class="s2">&quot; does not exist! A valid path to a valid DOE2 weather textfile&quot;</span> <span class="o">+</span>
                        <span class="s2">&quot; file must be provided.&quot;</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="DOE2Weather.df2bin"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.df2bin">[docs]</a>    <span class="k">def</span> <span class="nf">df2bin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="p">,</span> <span class="n">binfilename</span><span class="p">,</span> <span class="n">use_exe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hour_in_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">txt2bin_exepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">fyear</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">timezone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">iwsz</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">iftyp</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">clearness_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">ground_temp</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        df2bin(df, binfilename, start_datetime, hour_in_file, txt2bin_exepath,</span>
<span class="sd">               location=None,fyear=None,latitude=None,longitude=None,timezone=None,</span>
<span class="sd">               iwsz=2,iftyp=3,clearness_number=None,ground_temp=None)</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            df              : pd.Dataframe: must contain the columns originally read from a</span>
<span class="sd">                                   DOE2 BIN weather file format (in the table below)</span>
<span class="sd">                                   if use_exe = False, df must have a </span>
<span class="sd">            binfilename     : str : path and filename that will be output with the</span>
<span class="sd">                                   weather signals in df.</span>
<span class="sd">            use_exe         : bool : optional : Default=False</span>
<span class="sd">                                    Set to True if using TXT2BIN is desired </span>
<span class="sd">                                    instead of python. Changing use_exe between</span>
<span class="sd">                                    reads and writes is not allowed</span>
<span class="sd">            </span>
<span class="sd">            All other parameters only apply if use_exe = True                         </span>
<span class="sd">                                    </span>
<span class="sd">            start_datetime  : datetime :start date and time to be output in the weather file</span>
<span class="sd">                                    typically this is Jan 1st, fyear</span>
<span class="sd">            hour_in_file    : int : Either 8760 or 8784</span>
<span class="sd">            txt2bin_exepath : str : path and filename that point to TXT2BIN.EXE</span>
<span class="sd">                                    DOE2 utility that can be obtained from www.doe2.com</span>
<span class="sd">                                    after forming a license agreement with James Hirsch</span>
<span class="sd">                                    and associates.</span>
<span class="sd">            location .. and all other inputs</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        </span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        %% From TXT2BIN.FMT - this gives the exact format needed to output a</span>
<span class="sd">        %                     text file that TXT2BIN.EXE can process.</span>
<span class="sd">        %       THIS DOCUMENTS A FORMATTED WEATHER FILE (WEATHER.FMT) MADE FROM</span>
<span class="sd">        %       A PACKED BINARY DOE2 WEATHER FILE (WEATHER.BIN) USING WTHFMT2.EXE</span>
<span class="sd">        %       AND THE EXTRA FILE NEEDED (not really!) TO PACK IT WITH FMTWTH2.EXE</span>
<span class="sd">        %  </span>
<span class="sd">        % on input.dat:              </span>
<span class="sd">        % </span>
<span class="sd">        % Record 1       IWSZ,IFTYP</span>
<span class="sd">        %                FORMAT(12X,I1,17X,I1)     </span>
<span class="sd">        % </span>
<span class="sd">        %       IWSZ           WORD SIZE          1 = 60-BIT, 2 = 30-BIT</span>
<span class="sd">        %       IFTYP          FILE TYPE          1 = OLD, 2 = NORMAL (NO SOLAR),</span>
<span class="sd">        %                                         3 = THE DATA HAS SOLAR</span>
<span class="sd">        % on weather.fmt:              </span>
<span class="sd">        % </span>
<span class="sd">        % Record 1       (IWDID(I),I=1,5),IWYR,WLAT,WLONG,IWTZN,IWSOL</span>
<span class="sd">        %                FORMAT(5A4,I5,2F8.2,2I5)     </span>
<span class="sd">        % </span>
<span class="sd">        % Record 2       (CLN(I),I=1,12)</span>
<span class="sd">        %                FORMAT(12F6.2)      </span>
<span class="sd">        % </span>
<span class="sd">        % Record 3       (GT(I),I=1,12)</span>
<span class="sd">        %                FORMAT(12F6.1)</span>
<span class="sd">        % </span>
<span class="sd">        % Records 4,8763</span>
<span class="sd">        %                KMON, KDAY, KH, WBT, DBT, PATM, CLDAMT, ISNOW, </span>
<span class="sd">        %                IRAIN, IWNDDR, HUMRAT, DENSTY, ENTHAL, SOLRAD,</span>
<span class="sd">        %                DIRSOL, ICLDTY, WNDSPD</span>
<span class="sd">        %                FORMAT(3I2,2F5.0,F6.1,F5.0,2I3,I4,F7.4,F6.3,F6.1,2F7.1,I3,F5.0)      </span>
<span class="sd">        %       IWDID          LOCATION I.D.</span>
<span class="sd">        %       IWYR           YEAR</span>
<span class="sd">        %       WLAT           LATITUDE</span>
<span class="sd">        %       WLONG          LONGITUDE</span>
<span class="sd">        %       IWTZN          TIME ZONE NUMBER</span>
<span class="sd">        %       IWSOL          SOLAR FLAG         IWSOL = IWSZ + (IFTYP-1)*2 - 1</span>
<span class="sd">        %       CLN            CLEARNESS NO.</span>
<span class="sd">        %       GT             GROUND TEMP.       (DEG R)</span>
<span class="sd">        %       KMON           MONTH              (1-12)</span>
<span class="sd">        %       KDAY           DAY OF MONTH</span>
<span class="sd">        %       KH             HOUR OF DAY</span>
<span class="sd">        %       WBT            WET BULB TEMP      (DEG F)</span>
<span class="sd">        %       DBT            DRY BULB TEMP      (DEG F)</span>
<span class="sd">        %       PATM           PRESSURE           (INCHES OF HG)</span>
<span class="sd">        %       CLDAMT         CLOUD AMOUNT       (0 - 10)</span>
<span class="sd">        %       ISNOW          SNOW FLAG          (1 = SNOWFALL)</span>
<span class="sd">        %       IRAIN          RAIN FLAG          (1 = RAINFALL)</span>
<span class="sd">        %       IWNDDR         WIND DIRECTION     (0 - 15; 0=N, 1=NNE, ETC)</span>
<span class="sd">        %       HUMRAT         HUMIDITY RATIO     (LB H2O/LB AIR)</span>
<span class="sd">        %       DENSTY         DENSITY OF AIR     (LB/CU FT)</span>
<span class="sd">        %       ENTHAL         SPECIFIC ENTHALPY  (BTU/LB)</span>
<span class="sd">        %       SOLRAD         TOTAL HOR. SOLAR   (BTU/HR-SQFT)</span>
<span class="sd">        %       DIRSOL         DIR. NORMAL SOLAR  (BTU/HR-SQFT)</span>
<span class="sd">        %       ICLDTY         CLOUD TYPE         (0 - 2)</span>
<span class="sd">        %       WNDSPD         WIND SPEED         KNOTS&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;use_exe&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_exe</span> <span class="o">!=</span> <span class="n">use_exe</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This class does not support switching between&quot;</span><span class="o">+</span>
                                 <span class="s2">&quot; using Python and using the BIN2TXT.F and TXT2BIN.F&quot;</span><span class="o">+</span>
                                 <span class="s2">&quot; executables!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_exe</span> <span class="o">=</span> <span class="n">use_exe</span>
        

        <span class="k">if</span> <span class="n">use_exe</span><span class="p">:</span>        
            <span class="n">cdir</span> <span class="o">=</span> <span class="n">pwd</span><span class="p">()</span>
            <span class="c1">#try:</span>
            <span class="n">change_dir</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">binfilename</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span> 
            <span class="k">if</span> <span class="n">change_dir</span><span class="p">:</span>
                <span class="n">cd</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">binfilename</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rm_file</span><span class="p">(</span><span class="s2">&quot;WEATHER.BIN&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;INPUT.DAT&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dat</span><span class="p">:</span>
                <span class="n">dat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;            </span><span class="si">{0:1.0f}</span><span class="s1">                 </span><span class="si">{1:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iwsz</span><span class="p">,</span><span class="n">iftyp</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fmt</span><span class="p">:</span>
                <span class="c1"># 3 header rows</span>
    <span class="c1"># header_dtype = np.dtype([(&#39;location_IWDID&#39;,&#39;a20&#39;),</span>
    <span class="c1">#                                         (&#39;year_IWYR&#39;, &#39;i4&#39;),</span>
    <span class="c1">#                                         (&#39;latitude_WLAT&#39;,&#39;f4&#39;),</span>
    <span class="c1">#                                         (&#39;longitude_WLONG&#39;,&#39;f4&#39;),</span>
    <span class="c1">#                                         (&#39;timezone_IWTZN&#39;,&#39;i4&#39;),</span>
    <span class="c1">#                                         (&#39;record_length_LRECX&#39;,&#39;i4&#39;),</span>
    <span class="c1">#                                         (&#39;number_days_NUMDAY&#39;,&#39;i4&#39;),</span>
    <span class="c1">#                                         (&#39;clearness_number_CLN_IM1&#39;,&#39;f4&#39;),</span>
    <span class="c1">#                                         (&#39;ground_temperature_GT_IM1&#39;,&#39;f4&#39;),</span>
    <span class="c1">#                                         (&#39;solar_flag_IWSOL&#39;,&#39;i4&#39;)])                </span>
                
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">bytes_</span><span class="p">):</span>
                    <span class="n">location_str</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">location_str</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    
                <span class="n">row1</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:20s}{1:5d}{2:8.2f}{3:8.2f}{4:5d}{5:5d}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">location_str</span><span class="p">,</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;year_IWYR&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;latitude_WLAT&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                    <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;longitude_WLONG&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                    <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;timezone_IWTZN&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;solar_flag_IWSOL&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row1</span><span class="p">)</span>
                <span class="n">clearness_number</span> <span class="o">=</span> <span class="p">[</span><span class="n">head</span><span class="p">[</span><span class="s1">&#39;clearness_number_CLN_IM1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
                <span class="n">ground_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">head</span><span class="p">[</span><span class="s1">&#39;ground_temperature_GT_IM1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">head</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">headers</span><span class="p">]</span>
                
                <span class="n">fmt</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="mi">12</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:6.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">clearness_number</span><span class="p">))</span>
                <span class="n">fmt</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="mi">12</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:6.2f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">ground_temp</span><span class="p">))</span>
                
                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="n">fmt</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="mi">3</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:2.0f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:5.0f}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{:6.1f}{:5.0f}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:3.0f}</span><span class="s1">&#39;</span> <span class="o">+</span> 
                     <span class="s1">&#39;</span><span class="si">{:4.0f}{:7.4f}{:6.3f}{:6.1f}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="s1">&#39;</span><span class="si">{:7.1f}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">{:3.0f}{:5.0f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                             <span class="o">*</span><span class="n">row</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">txt2bin_exepath</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">change_dir</span><span class="p">:</span>
                    <span class="n">cp</span><span class="p">(</span><span class="n">txt2bin_exepath</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cp</span><span class="p">(</span><span class="n">txt2bin_exepath</span><span class="p">,</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                <span class="n">new_exe_path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="n">basename</span><span class="p">(</span><span class="n">txt2bin_exepath</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">txt2bin</span><span class="p">(</span><span class="s2">&quot;WEATHER.FMT&quot;</span><span class="p">,</span><span class="n">new_exe_path</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">binfilename</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cd</span><span class="p">(</span><span class="n">cdir</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;The txt2bin.exe utility is not present at: </span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">txt2bin_exepath</span><span class="p">)</span>        
            <span class="n">cd</span><span class="p">(</span><span class="n">cdir</span><span class="p">)</span>    
        
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># size and type checking</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">column_description</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This function only handles dataframes with&quot;</span><span class="o">+</span>
                                 <span class="s2">&quot; 17 columns as defined for DOE-2 BIN weather files!&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;headers&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input dataframe df must have an attribute &quot;</span><span class="o">+</span>
                                 <span class="s2">&quot;&#39;headers&#39; that contains a list of &quot;</span><span class="p">)</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">headers</span>
            <span class="n">DOE2Weather</span><span class="o">.</span><span class="n">write_doe2_bin</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">binfilename</span><span class="p">)</span></div>


<div class="viewcode-block" id="DOE2Weather.bin2df"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.bin2df">[docs]</a>    <span class="k">def</span> <span class="nf">bin2df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">binfilename</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hour_in_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bin2txt_exepath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timezone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_exe</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        This function was originally written in matlab and is the </span>
<span class="sd">        &quot;ReadDOE2BINTXTFile.m&quot; function except that it also includes conversion</span>
<span class="sd">        of the BIN file into a text file  </span>
<span class="sd">        </span>
<span class="sd">        DST is a list of the start of daylight savings and end so that</span>
<span class="sd">        adjustments can be made and the time stamps adjusted for daylight savings.</span>
<span class="sd">        the input filename.txt must come from a DOE2 bin file that has been</span>
<span class="sd">        converted to a text file. It has the following columns of information:</span>
<span class="sd">            </span>
<span class="sd">        %Column Number   Variable       Description        Units</span>
<span class="sd">        %C 1             IM2            MONTH              (1-12)</span>
<span class="sd">        %C 2             ID             DAY OF MONTH</span>
<span class="sd">        %C 3             IH             HOUR OF DAY</span>
<span class="sd">        %C 4             CALC(1)        WET BULB TEMP      (DEG F)</span>
<span class="sd">        %C 5             CALC(2)        DRY BULB TEMP      (DEG F)</span>
<span class="sd">        %C 6             CALC(3)        PRESSURE           (INCHES OF HG)</span>
<span class="sd">        %C 7             CALC(4)        CLOUD AMOUNT       (0 - 10)</span>
<span class="sd">        %C 8             ISNOW          SNOW FLAG          (1 = SNOWFALL)</span>
<span class="sd">        %C 9             IRAIN          RAIN FLAG          (1 = RAINFALL)</span>
<span class="sd">        %C 10            IWNDDR         WIND DIRECTION     (0 - 15; 0=N, 1=NNE, ETC)</span>
<span class="sd">        %C 11            CALC(8)        HUMIDITY RATIO     (LB H2O/LB AIR)</span>
<span class="sd">        %C 12            CALC(9)        DENSITY OF AIR     (LB/CU FT)</span>
<span class="sd">        %C 13            CALC(10)       SPECIFIC ENTHALPY  (BTU/LB)</span>
<span class="sd">        %C 14            CALC(11)       TOTAL HOR. SOLAR   (BTU/HR-SQFT)</span>
<span class="sd">        %C 15            CALC(12)       DIR. NORMAL SOLAR  (BTU/HR-SQFT)</span>
<span class="sd">        %C 16            ICLDTY         CLOUD TYPE         (0 - 2)</span>
<span class="sd">        %C 17            CALC(14)       WIND SPEED         KNOTS    </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">timezone</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">timezone</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">dst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The timezone and dst values must be specified together!&quot;</span><span class="p">)</span>
        
        
        <span class="n">hour_in_day</span> <span class="o">=</span> <span class="mi">24</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;use_exe&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">use_exe</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_exe</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;This class does not support switching between&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; using BIN2TXT.EXE and TXT2BIN.EXE and using&quot;</span> <span class="o">+</span>
                                 <span class="s2">&quot; Python for translation! None returned as a result!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># set the mode of operation of the class</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_exe</span> <span class="o">=</span> <span class="n">use_exe</span>
        
        <span class="k">if</span> <span class="n">use_exe</span><span class="p">:</span>
            <span class="c1"># this is the old way of doing things.</span>
            <span class="n">txtname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin2txt</span><span class="p">(</span><span class="n">binfilename</span><span class="p">,</span> <span class="n">bin2txt_exepath</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">txtname</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DOE2_Weather_Error</span><span class="p">(</span><span class="s2">&quot;bom2df:The bin file was not successfully converted please troubleshoot!&quot;</span><span class="p">)</span>

            <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">hour_in_file</span><span class="p">,</span><span class="mi">17</span><span class="p">))</span>
            <span class="c1"># this is specific to the conversion utility and how it writes out ASCII.</span>
            <span class="n">EntryLength</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">b_lines</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">txtname</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">text_line</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># skip three lines</span>
                        <span class="n">b_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text_line</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>  
                        <span class="k">for</span> <span class="n">mm</span><span class="p">,</span><span class="n">nn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cumsum</span><span class="p">(</span><span class="n">EntryLength</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">cumsum</span><span class="p">(</span><span class="n">EntryLength</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
                            <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">text_line</span><span class="p">[</span><span class="n">mm</span><span class="p">:</span><span class="n">nn</span><span class="p">])</span>
                            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="n">j</span> <span class="o">+=</span><span class="mi">1</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use pure python to do this </span>
            <span class="n">m</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_doe2_bin</span><span class="p">(</span><span class="n">binfilename</span><span class="p">)</span>
        
        <span class="c1"># adjust for leap year by repeating February 28th on February 29th.</span>
        <span class="k">if</span> <span class="n">hour_in_file</span> <span class="o">==</span> <span class="mi">8784</span><span class="p">:</span>
            <span class="c1"># February 28th is the 59th day of the year</span>
            <span class="c1"># Febrary 29th is the 60th day of a year</span>
            <span class="n">sid</span> <span class="o">=</span> <span class="mi">59</span> <span class="o">*</span> <span class="mi">24</span>
            
            <span class="c1"># shift all of March1st to December 31 over 24 hours</span>
            <span class="n">m</span><span class="p">[</span><span class="n">sid</span><span class="o">+</span><span class="mi">24</span><span class="p">:]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">sid</span><span class="p">:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span>
            <span class="c1"># repeat February 28th </span>
            <span class="n">m</span><span class="p">[</span><span class="n">sid</span><span class="p">:</span><span class="n">sid</span><span class="o">+</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">sid</span><span class="o">-</span><span class="mi">24</span><span class="p">:</span><span class="n">sid</span><span class="p">]</span>
            <span class="c1"># reassign Feb 28th to Feb 29th - </span>
            <span class="c1"># day of month column</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">column_description</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;DAY OF MONTH&quot;</span><span class="p">)</span>
            <span class="n">m</span><span class="p">[</span><span class="n">sid</span><span class="p">:</span><span class="n">sid</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="mi">29</span>
            <span class="n">MDAYS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">]</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">MDAYS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">]</span>
        
        
        
        <span class="n">dateVec</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reached_hours_to_next</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">start_datetime_was_None</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">get_year_from_headers</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="n">month</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0 = Jan</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">arange</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            
            <span class="c1"># see whether a replacement year has been provided - if not, use what</span>
            <span class="c1"># is in the BIN file - if Python is used, the the header of each</span>
            <span class="c1"># month can have a different year if it is TMY3</span>
            <span class="k">if</span> <span class="n">start_datetime</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">use_exe</span><span class="p">:</span>
                <span class="n">start_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]),</span><span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">start_datetime_was_None</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">start_datetime</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">reached_hours_to_next</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">use_exe</span><span class="p">:</span>
                <span class="n">hour_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">hours_to_next</span> <span class="o">=</span> <span class="n">MDAYS</span><span class="p">[</span><span class="n">month</span><span class="p">]</span><span class="o">*</span> <span class="n">hour_in_day</span>

                <span class="n">year</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="n">month</span><span class="p">][</span><span class="s1">&#39;year_IWYR&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">month</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">start_datetime_was_None</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">get_year_from_headers</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">use_exe</span> <span class="ow">and</span> <span class="n">start_datetime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">hour_count</span> <span class="o">+=</span> <span class="mi">1</span>

            
            <span class="k">if</span> <span class="n">get_year_from_headers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">hour_count</span> <span class="o">&gt;</span> <span class="n">hours_to_next</span><span class="p">:</span>    
                    <span class="n">reached_hours_to_next</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reached_hours_to_next</span> <span class="o">=</span> <span class="kc">False</span>

            
            <span class="c1"># for cases with a replacement year OR use_exe where the text file </span>
            <span class="c1"># does not convey the year at every header</span>
            <span class="k">if</span> <span class="n">use_exe</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">start_datetime_was_None</span><span class="p">:</span>

                <span class="n">current_time</span> <span class="o">=</span> <span class="n">start_datetime</span><span class="o">+</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="n">dateVec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">current_time</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">current_time</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                                        <span class="n">current_time</span><span class="o">.</span><span class="n">day</span><span class="p">,</span><span class="n">current_time</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
            <span class="c1"># </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dateVec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1">#Handle daylight savings correctly</span>
                <span class="k">if</span> <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dateVec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">DateOffset</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
            
                
        <span class="n">dateTimeIn</span> <span class="o">=</span> <span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">dateVec</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">timezone</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dateTimeIn</span> <span class="o">=</span> <span class="n">dateTimeIn</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="n">timezone</span><span class="p">,</span> <span class="n">ambiguous</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The time zone localization process failed. &quot;</span> 
                              <span class="o">+</span> <span class="s2">&quot; This probably happened because the time zone &quot;</span> 
                              <span class="o">+</span> <span class="s2">&quot;input is incorrect!&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">dateTimeIn</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_description</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
    
        <span class="c1"># add header information (different depending on use_exe)</span>
        
        <span class="c1"># suppress warnings here. - We want to add attributes to the dataframe</span>
        <span class="c1"># and are NOT trying to add columns</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_exe</span><span class="p">:</span>
            <span class="n">clearness_number</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b_lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ground_temps</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b_lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">month</span> <span class="o">=</span> <span class="mi">0</span>
            
            <span class="k">for</span> <span class="n">num</span><span class="p">,</span><span class="n">temp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">clearness_number</span><span class="p">,</span><span class="n">ground_temps</span><span class="p">):</span>
                <span class="n">header_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">],</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">25</span><span class="p">:</span><span class="mi">33</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">33</span><span class="p">:</span><span class="mi">41</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">41</span><span class="p">:</span><span class="mi">46</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">MDAYS</span><span class="p">[</span><span class="n">month</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">clearness_number</span><span class="p">[</span><span class="n">month</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">ground_temps</span><span class="p">[</span><span class="n">month</span><span class="p">]),</span>
                                     <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">b_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">46</span><span class="p">:</span><span class="mi">51</span><span class="p">]))]</span>
                <span class="n">lheaders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">header_list</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">DataFormats</span><span class="o">.</span><span class="n">header_dtype</span><span class="p">)</span>
 
                <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lheaders</span><span class="p">)</span>


        <span class="n">df</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">headers</span>
            
        <span class="k">return</span> <span class="n">df</span></div>
    
<div class="viewcode-block" id="DOE2Weather.read_doe2_bin"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.read_doe2_bin">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_doe2_bin</span><span class="p">(</span><span class="n">binfilename</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">binfilename</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bh</span><span class="p">:</span>
            <span class="n">bin_content</span> <span class="o">=</span> <span class="n">bh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        obj.read_doe2_bin(binfilename)</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        </span>
<span class="sd">        binfilename : str : valid path and file name to a DOE-2 *.BIN weather </span>
<span class="sd">                            file.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        </span>
<span class="sd">        m : np.array(x,17) : x = length of BIN file (ussually 8760)</span>
<span class="sd">            The columns of this array are:</span>
<span class="sd">                        </span>
<span class="sd">            % Column Number   Variable      Description         Units</span>
<span class="sd">            %C 1              IM2            MOMTH              (1-12)</span>
<span class="sd">            %C 2             ID             DAY OF MONTH</span>
<span class="sd">            %C 3             IH             HOUR OF DAY</span>
<span class="sd">            %C 4             CALC(1)        WET BULB TEMP      (DEG F)</span>
<span class="sd">            %C 5             CALC(2)        DRY BULB TEMP      (DEG F)</span>
<span class="sd">            %C 6             CALC(3)        PRESSURE           (INCHES OF HG)</span>
<span class="sd">            %C 7             CALC(4)        CLOUD AMOUNT       (0 - 10)</span>
<span class="sd">            %C 8             ISNOW          SNOW FLAG          (1 = SNOWFALL)</span>
<span class="sd">            %C 9             IRAIN          RAIN FLAG          (1 = RAINFALL)</span>
<span class="sd">            %C 10            IWNDDR         WIND DIRECTION     (0 - 15; 0=N, 1=NNE, ETC)</span>
<span class="sd">            %C 11            CALC(8)        HUMIDITY RATIO     (LB H2O/LB AIR)</span>
<span class="sd">            %C 12            CALC(9)        DENSITY OF AIR     (LB/CU FT)</span>
<span class="sd">            %C 13            CALC(10)       SPECIFIC ENTHALPY  (BTU/LB)</span>
<span class="sd">            %C 14            CALC(11)       TOTAL HOR. SOLAR   (BTU/HR-SQFT)</span>
<span class="sd">            %C 15            CALC(12)       DIR. NORMAL SOLAR  (BTU/HR-SQFT)</span>
<span class="sd">            %C 16            ICLDTY         CLOUD TYPE         (0 - 2)</span>
<span class="sd">            %C 17            CALC(14)       WIND SPEED         KNOTS    </span>
<span class="sd">            </span>
<span class="sd">        headers : list : list of np.array with specialized dtype to capture</span>
<span class="sd">            the header for each month of data in the DOE-2 *.BIN file.</span>
<span class="sd">            The dtype spec is as follows:</span>
<span class="sd">                np.dtype([(&#39;location_IWDID&#39;,&#39;a20&#39;),</span>
<span class="sd">                          (&#39;year_IWYR&#39;, &#39;i4&#39;),</span>
<span class="sd">                          (&#39;latitude_WLAT&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;longitude_WLONG&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;timezone_IWTZN&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;record_length_LRECX&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;number_days_NUMDAY&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;clearness_number_CLN_IM1&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;ground_temperature_GT_IM1&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;solar_flag_IWSOL&#39;,&#39;i4&#39;)])</span>
<span class="sd">        </span>
<span class="sd">        License Note:</span>
<span class="sd">        =============</span>
<span class="sd">        </span>
<span class="sd">        # THIS IS A TRANSLATION OF BIN2TXT.F except the TXT file is never written</span>
<span class="sd">        # because data for direct use in Python is desired.</span>
<span class="sd">        </span>
<span class="sd">        # THIS reverse engineering was approved by Jeff Hirsch on behalf of</span>
<span class="sd">        # James and Jeff Hirsch and Associates (JJH&amp;A)</span>
<span class="sd">        # along with putting the code on GITHUB with the contingency that the</span>
<span class="sd">        # JJH&amp;A license be acknowledged. The original correspondence is provided </span>
<span class="sd">        # below:</span>
<span class="sd">        </span>
<span class="sd">        # Wed 7/7/2021 4:10 PM</span>
<span class="sd">        Yes, you have my permission to distribute your DOE-2 weather file </span>
<span class="sd">        python libraries with TXT2BIN and BIN2TXT executables on Github or </span>
<span class="sd">        also translate the fortran source versions of those apps into python </span>
<span class="sd">        and then distribute on Github as long as your acknowledge the </span>
<span class="sd">        JJH&amp;A license</span>
<span class="sd"> </span>
<span class="sd">        ________________________________________</span>
<span class="sd">        Jeff Hirsch</span>
<span class="sd">        James J. Hirsch &amp; Associates</span>
<span class="sd">        Voice mail: (XXX) XXX-XXXX</span>
<span class="sd">        mobile: (XXX) XXX-XXXX</span>
<span class="sd">        -----------------------------------------------------</span>
<span class="sd">        From: Villa, Daniel L </span>
<span class="sd">        Sent: Wednesday, July 7, 2021 11:02 AM</span>
<span class="sd">        To: Jeff.Hirsch@DOE2.com </span>
<span class="sd">        Subject: Tranlate TXT2BIN.F and BIN2TXT.F into Python and distribute </span>
<span class="sd">                 as open source??</span>
<span class="sd">         </span>
<span class="sd">        Jeff,</span>
<span class="sd">         </span>
<span class="sd">        I have built a tool that inputs and outputs DOE-2 weather files with </span>
<span class="sd">        extreme events. I use the TXT2BIN.F and BIN2TXT.F executables with </span>
<span class="sd">        the version of DOE-2 that I have licensed with Hirsch and Associates. </span>
<span class="sd">        I would like to be able to distribute the python libraries with these </span>
<span class="sd">        executables on Github or else be able to translate the *.F files into </span>
<span class="sd">        python but know that the code is distributed under your license. </span>
<span class="sd">         </span>
<span class="sd">        Would Hirsch and Associates be willing to let me create Python </span>
<span class="sd">        versions of TXT2BIN.F and BIN2TXT.F and to distribute them as open </span>
<span class="sd">        source code on GitHUB? I understand and respect Hirsch and Associates </span>
<span class="sd">        decision if this is not allowed. Thank you.</span>
<span class="sd">         </span>
<span class="sd">        Daniel Villa</span>
<span class="sd">        Energy-Water System Integration Department 08825</span>
<span class="sd">        Sandia National Laboratories</span>
<span class="sd">        dlvilla@sandia.gov</span>
<span class="sd">        XXX-XXX-XXXX</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># initiate constants in BIN2TXT</span>
        <span class="n">MDAYS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">]</span>
        <span class="n">XMASK_1D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">99.</span><span class="p">,</span> <span class="o">-</span><span class="mf">99.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
                          <span class="mf">.0</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>
                          <span class="mf">.0001</span><span class="p">,</span> <span class="mf">.001</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
        <span class="n">XMASK</span> <span class="o">=</span> <span class="n">XMASK_1D</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        
        <span class="c1"># record length is 6200 and Fortran puts a 4 byte buffer at the beginning</span>
        <span class="c1"># and end of the record. making each record a total of 6208 bytes.</span>
        <span class="c1">#</span>
        <span class="n">recl</span> <span class="o">=</span> <span class="mi">6200</span> 
        <span class="n">num_buf_bytes</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">tot_recl</span> <span class="o">=</span> <span class="n">recl</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_buf_bytes</span>
        <span class="n">blocksize</span><span class="o">=</span><span class="mi">148992</span>
        
        <span class="n">header_length</span> <span class="o">=</span> <span class="mi">56</span>
        <span class="n">num_month_in_year</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">num_hour_in_day</span> <span class="o">=</span> <span class="mi">24</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># read in headers</span>
      <span class="c1">#   DO 100 IM1=1,12</span>
      <span class="c1">#   READ (10) (IWDID(I),I=1,5),IWYR,WLAT,WLONG,IWTZN,LRECX,NUMDAY,</span>
      <span class="c1"># _          CLN(IM1),GT(IM1),IWSOL</span>
      <span class="c1">#   READ (10) IDUM</span>
      <span class="c1">#   100 CONTINUE</span>
        
        <span class="k">for</span> <span class="n">IM1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_month_in_year</span><span class="p">):</span>
            <span class="n">head_start_byte</span> <span class="o">=</span> <span class="p">(</span><span class="n">recl</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_buf_bytes</span><span class="p">)</span> <span class="o">*</span> <span class="n">IM1</span> <span class="o">+</span> <span class="n">num_buf_bytes</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">bin_content</span><span class="p">[</span><span class="n">head_start_byte</span><span class="p">:</span><span class="n">head_start_byte</span><span class="o">+</span><span class="n">header_length</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
                                         <span class="n">dtype</span><span class="o">=</span><span class="n">DataFormats</span><span class="o">.</span><span class="n">header_dtype</span>
                                         <span class="p">,</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                            <span class="p">)</span>
        <span class="c1"># Read and process data</span>
        <span class="n">LRECX</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">byte_position</span> <span class="o">=</span> <span class="n">num_buf_bytes</span>
        <span class="n">IWTH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># keep 1 indexing and leave the first element 0</span>
        <span class="n">CALC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">data_records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">IDAT30</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1537</span><span class="p">)</span>
        <span class="n">iterIH</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">iter_max</span> <span class="o">=</span> <span class="mf">1e6</span>
        <span class="k">for</span> <span class="n">IM2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_month_in_year</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">IDE</span> <span class="o">=</span> <span class="n">MDAYS</span><span class="p">[</span><span class="n">IM2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IDE</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">IH</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">IH</span> <span class="o">&lt;=</span> <span class="n">num_hour_in_day</span> <span class="ow">and</span> <span class="n">iterIH</span> <span class="o">&lt;</span> <span class="n">iter_max</span><span class="p">:</span>
                    <span class="n">IRECX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">IM2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ID</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1">#105</span>
                    <span class="n">IDX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">ID</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">comparison</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">IRECX</span><span class="o">-</span><span class="n">LRECX</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">comparison</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">IDIF</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">LRECX</span> <span class="o">-</span> <span class="n">IRECX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">IDIF</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">byte_position</span><span class="p">,</span><span class="n">tot_recl</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">byte_position</span> <span class="o">&gt;</span> <span class="n">num_buf_bytes</span><span class="p">:</span>
                                <span class="n">byte_position</span> <span class="o">=</span> <span class="n">byte_position</span> <span class="o">-</span> <span class="n">tot_recl</span>
                            <span class="k">elif</span> <span class="n">byte_position</span> <span class="o">&gt;</span> <span class="n">num_buf_bytes</span><span class="p">:</span>
                                <span class="n">byte_position</span> <span class="o">=</span> <span class="n">byte_position</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">byte_position</span><span class="p">,</span><span class="n">tot_recl</span><span class="p">)</span>
                        <span class="n">next_record</span> <span class="o">=</span> <span class="n">byte_position</span> <span class="o">+</span> <span class="n">tot_recl</span>
                        <span class="n">cur_dat</span> <span class="o">=</span> <span class="n">DOE2Weather</span><span class="o">.</span><span class="n">_doe2_bin_data_format</span><span class="p">(</span><span class="n">bin_content</span><span class="p">,</span><span class="n">byte_position</span><span class="p">,</span><span class="n">next_record</span><span class="p">)</span>
                        <span class="n">LRECX</span> <span class="o">=</span> <span class="n">cur_dat</span><span class="p">[</span><span class="s1">&#39;record_length_LRECX&#39;</span><span class="p">]</span>
                        <span class="n">byte_position</span> <span class="o">=</span> <span class="n">next_record</span>
                    <span class="k">elif</span> <span class="n">comparison</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">IDAT30</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">cur_dat</span><span class="p">[</span><span class="s1">&#39;IDAT30&#39;</span><span class="p">]</span>
                        <span class="n">IP1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">96</span><span class="o">*</span><span class="p">(</span><span class="n">IDX</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">IH</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="p">]</span><span class="o">/</span><span class="mi">65536</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="p">],</span><span class="mi">65536</span><span class="p">)</span><span class="o">/</span><span class="mi">256</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="p">],</span><span class="mi">256</span><span class="p">)</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">1048576</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">1048576</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">1024</span><span class="p">)</span><span class="o">/</span><span class="mi">64</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">64</span><span class="p">)</span><span class="o">/</span><span class="mi">32</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">32</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">128</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="mi">128</span><span class="p">)</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="mi">2048</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span><span class="mi">2048</span><span class="p">)</span><span class="o">/</span><span class="mi">128</span>
                        <span class="n">IWTH</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">IDAT30</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span><span class="mi">128</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
                            <span class="n">CALC</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">IWTH</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">*</span><span class="n">XMASK</span><span class="p">[</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">XMASK</span><span class="p">[</span><span class="n">I</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        
                        
                        <span class="n">ISNOW</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">CALC</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.01</span><span class="p">)</span>
                        <span class="n">IRAIN</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">CALC</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.01</span><span class="p">)</span>
                        <span class="n">IWNDDR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">CALC</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.01</span><span class="p">)</span>
                        <span class="n">ICLDTY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">CALC</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.01</span><span class="p">)</span>
                        
                        <span class="n">data_records</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">IM2</span><span class="p">,</span><span class="n">ID</span><span class="p">,</span><span class="n">IH</span><span class="p">,</span><span class="n">CALC</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">CALC</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">CALC</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                             <span class="n">CALC</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">ISNOW</span><span class="p">,</span><span class="n">IRAIN</span><span class="p">,</span><span class="n">IWNDDR</span><span class="p">,</span><span class="n">CALC</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
                                             <span class="n">CALC</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">CALC</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span><span class="n">CALC</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span><span class="n">CALC</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span>
                                             <span class="n">ICLDTY</span><span class="p">,</span><span class="n">CALC</span><span class="p">[</span><span class="mi">14</span><span class="p">]])</span>
                        <span class="n">IH</span> <span class="o">+=</span> <span class="mi">1</span>
               
                    <span class="k">elif</span> <span class="n">comparison</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">next_record</span> <span class="o">=</span> <span class="n">byte_position</span> <span class="o">+</span> <span class="n">tot_recl</span>
                        <span class="n">cur_dat</span> <span class="o">=</span> <span class="n">DOE2Weather</span><span class="o">.</span><span class="n">_doe2_bin_data_format</span><span class="p">(</span><span class="n">bin_content</span><span class="p">,</span><span class="n">byte_position</span><span class="p">,</span><span class="n">next_record</span><span class="p">)</span>
                        <span class="n">LRECX</span> <span class="o">=</span> <span class="n">cur_dat</span><span class="p">[</span><span class="s1">&#39;record_length_LRECX&#39;</span><span class="p">]</span>
                        <span class="n">byte_position</span> <span class="o">=</span> <span class="n">next_record</span>
                        
                    <span class="n">iterIH</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">iterIH</span> <span class="o">&gt;=</span> <span class="n">iter_max</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">StopIteration</span><span class="p">(</span><span class="s2">&quot;The while loop over days has gotten&quot;</span>
                                        <span class="o">+</span><span class="s2">&quot; stuck! The file being read may not&quot;</span>
                                        <span class="o">+</span><span class="s2">&quot; be the correct BIN Format for DOE-2.&quot;</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_records</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">headers</span> </div>
                        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_doe2_bin_data_format</span><span class="p">(</span><span class="n">bin_content</span><span class="p">,</span><span class="n">byte_position</span><span class="p">,</span><span class="n">next_record</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">bin_content</span><span class="p">[</span><span class="n">byte_position</span><span class="p">:</span><span class="n">next_record</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">,</span><span class="s1">&#39;a20&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;year_IWYR&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;latitude_WLAT&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;longitude_WLONG&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;timezone_IWTZN&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;record_length_LRECX&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;number_days_NUMDAY&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;clearness_number_CLN_IM1&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;ground_temperature_GT_IM1&#39;</span><span class="p">,</span><span class="s1">&#39;f4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;solar_flag_IDUM&#39;</span><span class="p">,</span><span class="s1">&#39;i4&#39;</span><span class="p">),</span>
                                            <span class="p">(</span><span class="s1">&#39;IDAT30&#39;</span><span class="p">,</span><span class="s1">&#39;1536i4&#39;</span><span class="p">)]),</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>    
<div class="viewcode-block" id="DOE2Weather.write_doe2_bin"><a class="viewcode-back" href="../../../mews.weather.doe2weather.html#mews.weather.doe2weather.DOE2Weather.write_doe2_bin">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">write_doe2_bin</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">headers</span><span class="p">,</span><span class="n">binfilename</span><span class="p">,</span><span class="n">IWSZ</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFTYP</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOE2Weather.write_doe2_bin(m,headers,binfilename,IWSZ=1,IFTYP=2)</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        m : np.array(x,17) : x = length of BIN file (ussually 8760)</span>
<span class="sd">            The columns of this array are:</span>
<span class="sd">                        </span>
<span class="sd">            % Column Number   Variable      Description         Units</span>
<span class="sd">            %C 1              IM2            MOMTH              (1-12)</span>
<span class="sd">            %C 2             ID             DAY OF MONTH</span>
<span class="sd">            %C 3             IH             HOUR OF DAY</span>
<span class="sd">            %C 4             CALC(1)        WET BULB TEMP      (DEG F)</span>
<span class="sd">            %C 5             CALC(2)        DRY BULB TEMP      (DEG F)</span>
<span class="sd">            %C 6             CALC(3)        PRESSURE           (INCHES OF HG)</span>
<span class="sd">            %C 7             CALC(4)        CLOUD AMOUNT       (0 - 10)</span>
<span class="sd">            %C 8             ISNOW          SNOW FLAG          (1 = SNOWFALL)</span>
<span class="sd">            %C 9             IRAIN          RAIN FLAG          (1 = RAINFALL)</span>
<span class="sd">            %C 10            IWNDDR         WIND DIRECTION     (0 - 15; 0=N, 1=NNE, ETC)</span>
<span class="sd">            %C 11            CALC(8)        HUMIDITY RATIO     (LB H2O/LB AIR)</span>
<span class="sd">            %C 12            CALC(9)        DENSITY OF AIR     (LB/CU FT)</span>
<span class="sd">            %C 13            CALC(10)       SPECIFIC ENTHALPY  (BTU/LB)</span>
<span class="sd">            %C 14            CALC(11)       TOTAL HOR. SOLAR   (BTU/HR-SQFT)</span>
<span class="sd">            %C 15            CALC(12)       DIR. NORMAL SOLAR  (BTU/HR-SQFT)</span>
<span class="sd">            %C 16            ICLDTY         CLOUD TYPE         (0 - 2)</span>
<span class="sd">            %C 17            CALC(14)       WIND SPEED         KNOTS    </span>
<span class="sd">            </span>
<span class="sd">        headers : list : list of np.array with specialized dtype to capture</span>
<span class="sd">            the header for each month of data in the DOE-2 filename.BIN file.</span>
<span class="sd">            The dtype spec is as follows:</span>
<span class="sd">                </span>
<span class="sd">                np.dtype([(&#39;location_IWDID&#39;,&#39;a20&#39;),</span>
<span class="sd">                          (&#39;year_IWYR&#39;, &#39;i4&#39;),</span>
<span class="sd">                          (&#39;latitude_WLAT&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;longitude_WLONG&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;timezone_IWTZN&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;record_length_LRECX&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;number_days_NUMDAY&#39;,&#39;i4&#39;),</span>
<span class="sd">                          (&#39;clearness_number_CLN_IM1&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;ground_temperature_GT_IM1&#39;,&#39;f4&#39;),</span>
<span class="sd">                          (&#39;solar_flag_IWSOL&#39;,&#39;i4&#39;)])</span>

<span class="sd">                </span>
<span class="sd">        binfilename : str : valid path/filename for which a file will be </span>
<span class="sd">            written.</span>
<span class="sd">                </span>
<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        None </span>
<span class="sd">        </span>
<span class="sd">        License Note:</span>
<span class="sd">        =============</span>
<span class="sd">        </span>
<span class="sd">        # THIS IS A TRANSLATION OF TXT2BIN.F except the TXT file is never read</span>
<span class="sd">        # from because data is coming from Python.</span>
<span class="sd">        </span>
<span class="sd">        # THIS reverse engineering was approved by Jeff Hirsch on behalf of</span>
<span class="sd">        # James and Jeff Hirsch and Associates (JJH&amp;A)</span>
<span class="sd">        # along with putting the code on GITHUB with the contingency that the</span>
<span class="sd">        # JJH&amp;A license be acknowledged. The original correspondence is provided </span>
<span class="sd">        # below:</span>
<span class="sd">        </span>
<span class="sd">        # Wed 7/7/2021 4:10 PM</span>
<span class="sd">        Yes, you have my permission to distribute your DOE-2 weather file </span>
<span class="sd">        python libraries with TXT2BIN and BIN2TXT executables on Github or </span>
<span class="sd">        also translate the fortran source versions of those apps into python </span>
<span class="sd">        and then distribute on Github as long as your acknowledge the </span>
<span class="sd">        JJH&amp;A license</span>
<span class="sd"> </span>
<span class="sd">        ________________________________________</span>
<span class="sd">        Jeff Hirsch</span>
<span class="sd">        James J. Hirsch &amp; Associates</span>
<span class="sd">        Voice mail: (XXX) XXX-XXXX</span>
<span class="sd">        mobile: (XXX) XXX-XXXX</span>
<span class="sd">        -----------------------------------------------------</span>
<span class="sd">        From: Villa, Daniel L </span>
<span class="sd">        Sent: Wednesday, July 7, 2021 11:02 AM</span>
<span class="sd">        To: Jeff.Hirsch@DOE2.com </span>
<span class="sd">        Subject: Tranlate TXT2BIN.F and BIN2TXT.F into Python and distribute </span>
<span class="sd">                 as open source??</span>
<span class="sd">         </span>
<span class="sd">        Jeff,</span>
<span class="sd">         </span>
<span class="sd">        I have built a tool that inputs and outputs DOE-2 weather files with </span>
<span class="sd">        extreme events. I use the TXT2BIN.F and BIN2TXT.F executables with </span>
<span class="sd">        the version of DOE-2 that I have licensed with Hirsch and Associates. </span>
<span class="sd">        I would like to be able to distribute the python libraries with these </span>
<span class="sd">        executables on Github or else be able to translate the *.F files into </span>
<span class="sd">        python but know that the code is distributed under your license. </span>
<span class="sd">         </span>
<span class="sd">        Would Hirsch and Associates be willing to let me create Python </span>
<span class="sd">        versions of TXT2BIN.F and BIN2TXT.F and to distribute them as open </span>
<span class="sd">        source code on GitHUB? I understand and respect Hirsch and Associates </span>
<span class="sd">        decision if this is not allowed. Thank you.</span>
<span class="sd">         </span>
<span class="sd">        Daniel Villa</span>
<span class="sd">        Energy-Water System Integration Department 08825</span>
<span class="sd">        Sandia National Laboratories</span>
<span class="sd">        dlvilla@sandia.gov</span>
<span class="sd">        XXX-XXX-XXXX</span>
<span class="sd">        </span>
<span class="sd">        FORTRAN VARIABLE MEANING KEY:</span>
<span class="sd">            </span>
<span class="sd">            C              </span>
<span class="sd">            C     IWSZ           WORD SIZE          1 = 60-BIT, 2 = 30-BIT</span>
<span class="sd">            C     IFTYP          FILE TYPE          1 = OLD, 2 = NORMAL (NO SOLAR),</span>
<span class="sd">            C                                       3 = THE DATA HAS SOLAR</span>
<span class="sd">            C     IWDID          LOCATION I.D.</span>
<span class="sd">            C     IWYR           YEAR</span>
<span class="sd">            C     WLAT           LATITUDE</span>
<span class="sd">            C     WLONG          LONGITUDE</span>
<span class="sd">            C     IWTZN          TIME ZONE NUMBER</span>
<span class="sd">            C     IWSOL          SOLAR FLAG         FUNCTION OF IWSZ + IFTYP</span>
<span class="sd">            C     CLN            CLEARNESS NO.</span>
<span class="sd">            C     GT             GROUND TEMP.       (DEG R)</span>
<span class="sd">            C     KMON           MONTH              (1-12)</span>
<span class="sd">            C     KDAY           DAY OF MONTH</span>
<span class="sd">            C     KH             HOUR OF DAY</span>
<span class="sd">            C     WBT            WET BULB TEMP      (DEG F)</span>
<span class="sd">            C     DBT            DRY BULB TEMP      (DEG F)</span>
<span class="sd">            C     PATM           PRESSURE           (INCHES OF HG)</span>
<span class="sd">            C     CLDAMT         CLOUD AMOUNT       (0 - 10)</span>
<span class="sd">            C     ISNOW          SNOW FLAG          (1 = SNOWFALL)</span>
<span class="sd">            C     IRAIN          RAIN FLAG          (1 = RAINFALL)</span>
<span class="sd">            C     IWNDDR         WIND DIRECTION     (0 - 15; 0=N, 1=NNE, ETC)</span>
<span class="sd">            C     HUMRAT         HUMIDITY RATIO     (LB H2O/LB AIR)</span>
<span class="sd">            C     DENSTY         DENSITY OF AIR     (LB/CU FT)</span>
<span class="sd">            C     ENTHAL         SPECIFIC ENTHALPY  (BTU/LB)</span>
<span class="sd">            C     SOLRAD         TOTAL HOR. SOLAR   (BTU/HR-SQFT)</span>
<span class="sd">            C     DIRSOL         DIR. NORMAL SOLAR  (BTU/HR-SQFT)</span>
<span class="sd">            C     ICLDTY         CLOUD TYPE         (0 - 2)</span>
<span class="sd">            C     WNDSPD         WIND SPEED         KNOTS</span>

<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="c1"># record length is 6200 and Fortran puts a 4 byte buffer at the beginning</span>
        <span class="c1"># and end of the record. making each record a total of 6208 bytes.</span>
        <span class="c1">#</span>
        <span class="n">recl</span> <span class="o">=</span> <span class="mi">6200</span> 
        <span class="n">num_buf_bytes</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">tot_recl</span> <span class="o">=</span> <span class="n">recl</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">num_buf_bytes</span>
        <span class="n">num_month_in_year</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">num_hour_in_day</span> <span class="o">=</span> <span class="mi">24</span>
        
        <span class="n">CLN</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">GT</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">IWYR</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">WLAT</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">WLONG</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">IWTZN</span> <span class="o">=</span> <span class="p">[];</span> 
        <span class="n">LRECX</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">NUMDAY</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">IWSOL</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">IWDID</span> <span class="o">=</span> <span class="p">[];</span>
        
        <span class="c1"># translate to the original syntax for clarity</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="n">IWDID</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;location_IWDID&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">CLN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;clearness_number_CLN_IM1&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">GT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;ground_temperature_GT_IM1&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">IWYR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;year_IWYR&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">WLAT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;latitude_WLAT&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">WLONG</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;longitude_WLONG&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">IWTZN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;timezone_IWTZN&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">LRECX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;record_length_LRECX&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c1">#not needed</span>
            <span class="n">NUMDAY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;number_days_NUMDAY&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># not needed</span>
            <span class="n">IWSOL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;solar_flag_IWSOL&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># not needed recalculated here</span>
        
        <span class="n">MDAYS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_month_in_year</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">MDAYS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">31</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">])</span>
        <span class="n">IDAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1536</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

        <span class="c1"># record buffer. TODO- find out the exact 4 bytes FORTRAN puts here!</span>
        <span class="n">IDUM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">recl</span><span class="p">)</span>  <span class="c1"># Fortran buffers with 4 bytes at the begin and</span>
                            <span class="c1"># end of each record indicating the length in bytes </span>
                            <span class="c1"># of the record.</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">IWSZ</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;IWSZ = 0 does not work in Python because the WEATHER.FMT file does not exist!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IWSOL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">IWSZ</span> <span class="o">+</span> <span class="p">(</span><span class="n">IFTYP</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># ARRAYS are zero base! - The fortran is base 1 - watch out!</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">binfilename</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">,</span><span class="n">buffering</span><span class="o">=</span><span class="n">tot_recl</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">IM</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_month_in_year</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">IDE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">MDAYS</span><span class="p">[</span><span class="n">IM</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">ID</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IDE</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    
                    <span class="n">IRECXO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">IM</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">ID</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">IDXO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">ID</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    
                    <span class="k">for</span> <span class="n">IH</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_hour_in_day</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>

                        <span class="n">KMON</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>      <span class="c1"># Month</span>
                        <span class="n">KDAY</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>      <span class="c1"># Day</span>
                        <span class="n">KH</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>        <span class="c1"># Hour</span>
                        <span class="n">WBT</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>       <span class="c1"># Wet bulb temperature (F)</span>
                        <span class="n">DBT</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>       <span class="c1"># Dry bulb temperature (F)</span>
                        <span class="n">PATM</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>      <span class="c1"># Atmospheric Pressure (in Hg)</span>
                        <span class="n">CLDAMT</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>    <span class="c1"># Cloud amount (0-10)</span>
                        <span class="n">ISNOW</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>     <span class="c1"># Snow flag (1=snowing)</span>
                        <span class="n">IRAIN</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>     <span class="c1"># Rainfall flag (1=precipitation happening)</span>
                        <span class="n">IWNDDR</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>    <span class="c1"># Wind Direction (0 - 15; 0=N, 1=NNE, ETC)</span>
                        <span class="n">HUMRAT</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>   <span class="c1"># Humidity ratio (lb h2o/lb air)</span>
                        <span class="n">DENSTY</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>   <span class="c1"># Air density (lb/ft3)</span>
                        <span class="n">ENTHAL</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span>   <span class="c1"># Enthalpy (BTU/LB)</span>
                        <span class="n">SOLRAD</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">13</span><span class="p">]</span>   <span class="c1"># Diffuse solar radiation (BTU/HR-SQFT)</span>
                        <span class="n">DIRSOL</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>   <span class="c1"># Direct solar radiation ((BTU/HR-SQFT))</span>
                        <span class="n">ICLDTY</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>   <span class="c1"># Cloud type (0-2)</span>
                        <span class="n">WNDSPD</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">count</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span>   <span class="c1"># Wind speed (knots)</span>
                        
                        <span class="n">ISOL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">SOLRAD</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">)</span>
                        <span class="n">IDN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">DIRSOL</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">)</span>
                        <span class="n">IWET</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">WBT</span><span class="o">+</span><span class="mf">99.5</span><span class="p">)</span>
                        <span class="n">IDRY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">DBT</span><span class="o">+</span><span class="mf">99.5</span><span class="p">)</span>
                        <span class="n">IPRES</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">PATM</span><span class="o">*</span><span class="mf">10.</span><span class="o">-</span><span class="mf">149.5</span><span class="p">)</span>
                        <span class="n">ICLDAM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">CLDAMT</span><span class="p">)</span>
                        <span class="n">IWNDSP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">WNDSPD</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
                        <span class="n">IHUMRT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">HUMRAT</span><span class="o">*</span><span class="mf">10000.</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span>
                        <span class="n">IDENS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">DENSTY</span><span class="o">*</span><span class="mf">1000.</span><span class="o">-</span><span class="mf">19.5</span><span class="p">)</span>
                        <span class="n">IENTH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">ENTHAL</span><span class="o">*</span><span class="mf">2.0</span><span class="o">+</span><span class="mf">60.5</span><span class="p">)</span>
                        <span class="n">IP1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">((</span><span class="n">IDXO</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">96</span> <span class="o">+</span> <span class="n">IH</span><span class="o">*</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
                        <span class="n">IDAT</span><span class="p">[</span><span class="n">IP1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">IPRES</span><span class="o">*</span><span class="mi">65536</span> <span class="o">+</span> <span class="n">IWET</span><span class="o">*</span><span class="mi">256</span> <span class="o">+</span> <span class="n">IDRY</span><span class="p">)</span>
                        <span class="n">IDAT</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">ISOL</span><span class="o">*</span><span class="mi">1048576</span> <span class="o">+</span> <span class="n">IDN</span><span class="o">*</span><span class="mi">1024</span> <span class="o">+</span> 
                                      <span class="n">ICLDAM</span><span class="o">*</span><span class="mi">64</span> <span class="o">+</span> <span class="n">ISNOW</span><span class="o">*</span><span class="mi">32</span> <span class="o">+</span> <span class="n">IRAIN</span><span class="o">*</span><span class="mi">16</span> <span class="o">+</span> <span class="n">IWNDDR</span><span class="p">)</span> 
                        <span class="n">IDAT</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">IHUMRT</span><span class="o">*</span><span class="mi">128</span> <span class="o">+</span> <span class="n">IDENS</span><span class="p">)</span>
                        <span class="n">IDAT</span><span class="p">[</span><span class="n">IP1</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">IENTH</span><span class="o">*</span><span class="mi">2048</span> <span class="o">+</span> <span class="n">ICLDTY</span><span class="o">*</span><span class="mi">128</span> <span class="o">+</span> <span class="n">IWNDSP</span><span class="p">)</span>
                        
                    <span class="k">if</span> <span class="n">ID</span> <span class="o">!=</span> <span class="mi">16</span> <span class="ow">and</span> <span class="n">ID</span> <span class="o">!=</span> <span class="n">IDE</span><span class="p">:</span>
                        <span class="k">pass</span> <span class="c1"># keep the loop </span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># IDUM is the padding written by Fortran that</span>
                        <span class="c1">#   has to be explicitly included here.</span>
                        <span class="n">byte_arr</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IDUM</span><span class="p">)</span>
                        <span class="n">byte_arr</span> <span class="o">=</span> <span class="n">byte_arr</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;20s&#39;</span><span class="p">,</span><span class="n">IWDID</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        
                        <span class="n">byte_arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte_arr</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IWYR</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="n">WLAT</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="n">WLONG</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IWTZN</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IRECXO</span><span class="p">)</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IDE</span><span class="p">)</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="n">CLN</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="n">GT</span><span class="p">[</span><span class="n">IM</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                                    <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IWSOL</span><span class="p">))</span> 
                        <span class="n">byte_arr</span> <span class="o">=</span> <span class="n">byte_arr</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">i4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i4</span> <span class="ow">in</span> <span class="n">IDAT</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span> 
                        <span class="n">byte_arr</span> <span class="o">=</span> <span class="n">byte_arr</span> <span class="o">+</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="n">IDUM</span><span class="p">)</span>
                        
                        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">byte_arr</span><span class="p">)</span>
                            
                            
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="c1"># end of write_doe2_bin     </span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>